

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>nltk.corpus.reader.timit &mdash; NLTK 2.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="top" title="NLTK 2.0 documentation" href="../../../../index.html" />
    <link rel="up" title="nltk.corpus.reader" href="../reader.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="../../../../index.html">NLTK 2.0 documentation</a></div>
        <div class="rel">
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for nltk.corpus.reader.timit</h1><div class="highlight"><pre>
<span class="c"># Natural Language Toolkit: TIMIT Corpus Reader</span>
<span class="c">#</span>
<span class="c"># Copyright (C) 2001-2007 NLTK Project</span>
<span class="c"># Author: Haejoong Lee &lt;haejoong@ldc.upenn.edu&gt;</span>
<span class="c">#         Steven Bird &lt;sb@ldc.upenn.edu&gt;</span>
<span class="c">#         Jacob Perkins &lt;japerk@gmail.com&gt;</span>
<span class="c"># URL: &lt;http://www.nltk.org/&gt;</span>
<span class="c"># For license information, see LICENSE.TXT</span>

<span class="c"># [xx] this docstring is out-of-date:</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Read tokens, phonemes and audio data from the NLTK TIMIT Corpus.</span>

<span class="sd">This corpus contains selected portion of the TIMIT corpus.</span>

<span class="sd"> - 16 speakers from 8 dialect regions</span>
<span class="sd"> - 1 male and 1 female from each dialect region</span>
<span class="sd"> - total 130 sentences (10 sentences per speaker.  Note that some</span>
<span class="sd">   sentences are shared among other speakers, especially sa1 and sa2</span>
<span class="sd">   are spoken by all speakers.)</span>
<span class="sd"> - total 160 recording of sentences (10 recordings per speaker)</span>
<span class="sd"> - audio format: NIST Sphere, single channel, 16kHz sampling,</span>
<span class="sd">  16 bit sample, PCM encoding</span>


<span class="sd">Module contents</span>
<span class="sd">===============</span>

<span class="sd">The timit corpus reader provides 4 functions and 4 data items.</span>

<span class="sd"> - utterances</span>

<span class="sd">   List of utterances in the corpus.  There are total 160 utterances,</span>
<span class="sd">   each of which corresponds to a unique utterance of a speaker.</span>
<span class="sd">   Here&#39;s an example of an utterance identifier in the list::</span>

<span class="sd">       dr1-fvmh0/sx206</span>
<span class="sd">         - _----  _---</span>
<span class="sd">         | |  |   | |</span>
<span class="sd">         | |  |   | |</span>
<span class="sd">         | |  |   | `--- sentence number</span>
<span class="sd">         | |  |   `----- sentence type (a:all, i:shared, x:exclusive)</span>
<span class="sd">         | |  `--------- speaker ID</span>
<span class="sd">         | `------------ sex (m:male, f:female)</span>
<span class="sd">         `-------------- dialect region (1..8)</span>

<span class="sd"> - speakers</span>

<span class="sd">   List of speaker IDs.  An example of speaker ID::</span>

<span class="sd">       dr1-fvmh0</span>

<span class="sd">   Note that if you split an item ID with colon and take the first element of</span>
<span class="sd">   the result, you will get a speaker ID.</span>

<span class="sd">       &gt;&gt;&gt; itemid = &#39;dr1-fvmh0/sx206&#39;</span>
<span class="sd">       &gt;&gt;&gt; spkrid , sentid = itemid.split(&#39;/&#39;)</span>
<span class="sd">       &gt;&gt;&gt; spkrid</span>
<span class="sd">       &#39;dr1-fvmh0&#39;</span>

<span class="sd">   The second element of the result is a sentence ID.</span>

<span class="sd"> - dictionary()</span>

<span class="sd">   Phonetic dictionary of words contained in this corpus.  This is a Python</span>
<span class="sd">   dictionary from words to phoneme lists.</span>

<span class="sd"> - spkrinfo()</span>

<span class="sd">   Speaker information table.  It&#39;s a Python dictionary from speaker IDs to</span>
<span class="sd">   records of 10 fields.  Speaker IDs the same as the ones in timie.speakers.</span>
<span class="sd">   Each record is a dictionary from field names to values, and the fields are</span>
<span class="sd">   as follows::</span>

<span class="sd">     id         speaker ID as defined in the original TIMIT speaker info table</span>
<span class="sd">     sex        speaker gender (M:male, F:female)</span>
<span class="sd">     dr         speaker dialect region (1:new england, 2:northern,</span>
<span class="sd">                3:north midland, 4:south midland, 5:southern, 6:new york city,</span>
<span class="sd">                7:western, 8:army brat (moved around))</span>
<span class="sd">     use        corpus type (TRN:training, TST:test)</span>
<span class="sd">                in this sample corpus only TRN is available</span>
<span class="sd">     recdate    recording date</span>
<span class="sd">     birthdate  speaker birth date</span>
<span class="sd">     ht         speaker height</span>
<span class="sd">     race       speaker race (WHT:white, BLK:black, AMR:american indian,</span>
<span class="sd">                SPN:spanish-american, ORN:oriental,???:unknown)</span>
<span class="sd">     edu        speaker education level (HS:high school, AS:associate degree,</span>
<span class="sd">                BS:bachelor&#39;s degree (BS or BA), MS:master&#39;s degree (MS or MA),</span>
<span class="sd">                PHD:doctorate degree (PhD,JD,MD), ??:unknown)</span>
<span class="sd">     comments   comments by the recorder</span>

<span class="sd">The 4 functions are as follows.</span>

<span class="sd"> - tokenized(sentences=items, offset=False)</span>

<span class="sd">   Given a list of items, returns an iterator of a list of word lists,</span>
<span class="sd">   each of which corresponds to an item (sentence).  If offset is set to True,</span>
<span class="sd">   each element of the word list is a tuple of word(string), start offset and</span>
<span class="sd">   end offset, where offset is represented as a number of 16kHz samples.</span>

<span class="sd"> - phonetic(sentences=items, offset=False)</span>

<span class="sd">   Given a list of items, returns an iterator of a list of phoneme lists,</span>
<span class="sd">   each of which corresponds to an item (sentence).  If offset is set to True,</span>
<span class="sd">   each element of the phoneme list is a tuple of word(string), start offset</span>
<span class="sd">   and end offset, where offset is represented as a number of 16kHz samples.</span>

<span class="sd"> - audiodata(item, start=0, end=None)</span>

<span class="sd">   Given an item, returns a chunk of audio samples formatted into a string.</span>
<span class="sd">   When the fuction is called, if start and end are omitted, the entire</span>
<span class="sd">   samples of the recording will be returned.  If only end is omitted,</span>
<span class="sd">   samples from the start offset to the end of the recording will be returned.</span>

<span class="sd"> - play(data)</span>

<span class="sd">   Play the given audio samples. The audio samples can be obtained from the</span>
<span class="sd">   timit.audiodata function.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">nltk.tree</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="kn">from</span> <span class="nn">nltk.internals</span> <span class="kn">import</span> <span class="n">import_from_stdlib</span>

<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">api</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="TimitCorpusReader"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader">[docs]</a><span class="k">class</span> <span class="nc">TimitCorpusReader</span><span class="p">(</span><span class="n">CorpusReader</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reader for the TIMIT corpus (or any other corpus with the same</span>
<span class="sd">    file layout and use of file formats).  The corpus root directory</span>
<span class="sd">    should contain the following files:</span>

<span class="sd">      - timitdic.txt: dictionary of standard transcriptions</span>
<span class="sd">      - spkrinfo.txt: table of speaker information</span>

<span class="sd">    In addition, the root directory should contain one subdirectory</span>
<span class="sd">    for each speaker, containing three files for each utterance:</span>

<span class="sd">      - &lt;utterance-id&gt;.txt: text content of utterances</span>
<span class="sd">      - &lt;utterance-id&gt;.wrd: tokenized text content of utterances</span>
<span class="sd">      - &lt;utterance-id&gt;.phn: phonetic transcription of utterances</span>
<span class="sd">      - &lt;utterance-id&gt;.wav: utterance sound file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_FILE_RE</span> <span class="o">=</span> <span class="p">(</span><span class="s">r&#39;(\w+-\w+/\w+\.(phn|txt|wav|wrd))|&#39;</span> <span class="o">+</span>
                <span class="s">r&#39;timitdic\.txt|spkrinfo\.txt&#39;</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;A regexp matching fileids that are used by this corpus reader.&quot;&quot;&quot;</span>
    <span class="n">_UTTERANCE_RE</span> <span class="o">=</span> <span class="s">r&#39;\w+-\w+/\w+\.txt&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a new TIMIT corpus reader in the given directory.</span>
<span class="sd">        :param root: The root directory for this corpus.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Ensure that wave files don&#39;t get treated as unicode data:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;.*\.wav&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;.*&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)]</span>

        <span class="n">CorpusReader</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span>
                              <span class="n">find_corpus_fileids</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FILE_RE</span><span class="p">),</span>
                              <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span>
                            <span class="n">find_corpus_fileids</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_UTTERANCE_RE</span><span class="p">)]</span>
        <span class="sd">&quot;&quot;&quot;A list of the utterance identifiers for all utterances in</span>
<span class="sd">        this corpus.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_speakerinfo</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speakers</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span><span class="p">))</span>

<div class="viewcode-block" id="TimitCorpusReader.fileids"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.fileids">[docs]</a>    <span class="k">def</span> <span class="nf">fileids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of file identifiers for the files that make up</span>
<span class="sd">        this corpus.</span>

<span class="sd">        :param filetype: If specified, then ``filetype`` indicates that</span>
<span class="sd">            only the files that have the given type should be</span>
<span class="sd">            returned.  Accepted values are: ``txt``, ``wrd``, ``phn``,</span>
<span class="sd">            ``wav``, or ``metadata``,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">CorpusReader</span><span class="o">.</span><span class="n">fileids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filetype</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;txt&#39;</span><span class="p">,</span> <span class="s">&#39;wrd&#39;</span><span class="p">,</span> <span class="s">&#39;phn&#39;</span><span class="p">,</span> <span class="s">&#39;wav&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">.</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">filetype</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s">&#39;metadata&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s">&#39;timitdic.txt&#39;</span><span class="p">,</span> <span class="s">&#39;spkrinfo.txt&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Bad value for filetype: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">filetype</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.utteranceids"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.utteranceids">[docs]</a>    <span class="k">def</span> <span class="nf">utteranceids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sex</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">spkrid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">sent_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sentid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A list of the utterance identifiers for all</span>
<span class="sd">        utterances in this corpus, or for the given speaker, dialect</span>
<span class="sd">        region, gender, sentence type, or sentence number, if</span>
<span class="sd">        specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">dialect</span> <span class="o">=</span> <span class="p">[</span><span class="n">dialect</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sex</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">sex</span> <span class="o">=</span> <span class="p">[</span><span class="n">sex</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spkrid</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">spkrid</span> <span class="o">=</span> <span class="p">[</span><span class="n">spkrid</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_type</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">sent_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent_type</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sentid</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">sentid</span> <span class="o">=</span> <span class="p">[</span><span class="n">sentid</span><span class="p">]</span>

        <span class="n">utterances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span><span class="p">[:]</span>
        <span class="k">if</span> <span class="n">dialect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">dialect</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">sex</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spkrid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span> <span class="k">if</span> <span class="n">u</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span> <span class="ow">in</span> <span class="n">spkrid</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sent_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="ow">in</span> <span class="n">sent_type</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sentid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span> <span class="ow">in</span> <span class="n">spkrid</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">utterances</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.transcription_dict"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.transcription_dict">[docs]</a>    <span class="k">def</span> <span class="nf">transcription_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A dictionary giving the &#39;standard&#39; transcription for</span>
<span class="sd">        each word.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_transcriptions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;timitdic.txt&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;;&#39;</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;\s*(\S+)\s+/(.*)/\s*$&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Bad line: </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">_transcriptions</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">_transcriptions</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.spkrid"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.spkrid">[docs]</a>    <span class="k">def</span> <span class="nf">spkrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterance</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">utterance</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.sentid"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.sentid">[docs]</a>    <span class="k">def</span> <span class="nf">sentid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterance</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">utterance</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.utterance"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.utterance">[docs]</a>    <span class="k">def</span> <span class="nf">utterance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spkrid</span><span class="p">,</span> <span class="n">sentid</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">spkrid</span><span class="p">,</span> <span class="n">sentid</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.spkrutteranceids"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.spkrutteranceids">[docs]</a>    <span class="k">def</span> <span class="nf">spkrutteranceids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speaker</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A list of all utterances associated with a given</span>
<span class="sd">        speaker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">utterance</span> <span class="k">for</span> <span class="n">utterance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span>
                <span class="k">if</span> <span class="n">utterance</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">speaker</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="p">)]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.spkrinfo"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.spkrinfo">[docs]</a>    <span class="k">def</span> <span class="nf">spkrinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speaker</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A dictionary mapping .. something.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">speaker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span><span class="p">:</span>
            <span class="n">speaker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spkrid</span><span class="p">(</span><span class="n">speaker</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_speakerinfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_speakerinfo</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;spkrinfo.txt&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;;&#39;</span><span class="p">:</span> <span class="k">continue</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="s">&quot;dr</span><span class="si">%s</span><span class="s">-</span><span class="si">%s%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_speakerinfo</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpeakerInfo</span><span class="p">(</span><span class="o">*</span><span class="n">rec</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_speakerinfo</span><span class="p">[</span><span class="n">speaker</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.phones"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.phones">[docs]</a>    <span class="k">def</span> <span class="nf">phones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.phn&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.phone_times"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.phone_times">[docs]</a>    <span class="k">def</span> <span class="nf">phone_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        offset is represented as a number of 16kHz samples!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.phn&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.words"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.words">[docs]</a>    <span class="k">def</span> <span class="nf">words</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.wrd&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.word_times"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.word_times">[docs]</a>    <span class="k">def</span> <span class="nf">word_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.wrd&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.sents"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.sents">[docs]</a>    <span class="k">def</span> <span class="nf">sents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                 <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.wrd&#39;</span><span class="p">)]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.sent_times"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.sent_times">[docs]</a>    <span class="k">def</span> <span class="nf">sent_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                 <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">fileid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterance_fileids</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="s">&#39;.txt&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileid</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.phone_trees"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.phone_trees">[docs]</a>    <span class="k">def</span> <span class="nf">phone_trees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">utterances</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">utterances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">utterances</span><span class="p">]</span>

        <span class="n">trees</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">utterance</span> <span class="ow">in</span> <span class="n">utterances</span><span class="p">:</span>
            <span class="n">word_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_times</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
            <span class="n">phone_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phone_times</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>
            <span class="n">sent_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sent_times</span><span class="p">(</span><span class="n">utterance</span><span class="p">)</span>

            <span class="k">while</span> <span class="n">sent_times</span><span class="p">:</span>
                <span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">sent_start</span><span class="p">,</span> <span class="n">sent_end</span><span class="p">)</span> <span class="o">=</span> <span class="n">sent_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">trees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">word_times</span> <span class="ow">and</span> <span class="n">phone_times</span> <span class="ow">and</span>
                       <span class="n">phone_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">word_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">trees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phone_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">while</span> <span class="n">word_times</span> <span class="ow">and</span> <span class="n">word_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sent_end</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">word_start</span><span class="p">,</span> <span class="n">word_end</span><span class="p">)</span> <span class="o">=</span> <span class="n">word_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">trees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tree</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="p">[]))</span>
                    <span class="k">while</span> <span class="n">phone_times</span> <span class="ow">and</span> <span class="n">phone_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">word_end</span><span class="p">:</span>
                        <span class="n">trees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phone_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">while</span> <span class="n">phone_times</span> <span class="ow">and</span> <span class="n">phone_times</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">sent_end</span><span class="p">:</span>
                    <span class="n">trees</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phone_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">trees</span>

    <span class="c"># [xx] NOTE: This is currently broken -- we&#39;re assuming that the</span>
    <span class="c"># fileids are WAV fileids (aka RIFF), but they&#39;re actually NIST SPHERE</span>
    <span class="c"># fileids.</span></div>
<div class="viewcode-block" id="TimitCorpusReader.wav"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.wav">[docs]</a>    <span class="k">def</span> <span class="nf">wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterance</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># nltk.chunk conflicts with the stdlib module &#39;chunk&#39;</span>
        <span class="n">wave</span> <span class="o">=</span> <span class="n">import_from_stdlib</span><span class="p">(</span><span class="s">&#39;wave&#39;</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">utterance</span><span class="o">+</span><span class="s">&#39;.wav&#39;</span><span class="p">),</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">getnframes</span><span class="p">()</span>

        <span class="c"># Skip past frames before start, then read the frames we want</span>
        <span class="n">w</span><span class="o">.</span><span class="n">readframes</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">readframes</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>

        <span class="c"># Open a new temporary file -- the wave module requires</span>
        <span class="c"># an actual file, and won&#39;t work w/ stringio. :(</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>

        <span class="c"># Write the parameters &amp; data to the new file.</span>
        <span class="n">out</span><span class="o">.</span><span class="n">setparams</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">getparams</span><span class="p">())</span>
        <span class="n">out</span><span class="o">.</span><span class="n">writeframes</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c"># Read the data back from the file, and return it.  The</span>
        <span class="c"># file will automatically be deleted when we return.</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TimitCorpusReader.audiodata"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.audiodata">[docs]</a>    <span class="k">def</span> <span class="nf">audiodata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterance</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="n">start</span><span class="p">)</span>
        <span class="n">headersize</span> <span class="o">=</span> <span class="mi">44</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">utterance</span><span class="o">+</span><span class="s">&#39;.wav&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">utterance</span><span class="o">+</span><span class="s">&#39;.wav&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">headersize</span><span class="o">+</span><span class="n">end</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">headersize</span><span class="o">+</span><span class="n">start</span><span class="o">*</span><span class="mi">2</span><span class="p">:]</span>
</div>
    <span class="k">def</span> <span class="nf">_utterance_fileids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterances</span><span class="p">,</span> <span class="n">extension</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">utterances</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">utterances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_utterances</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">utterances</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span> <span class="n">utterances</span> <span class="o">=</span> <span class="p">[</span><span class="n">utterances</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="s">&#39;</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utterances</span><span class="p">]</span>

<div class="viewcode-block" id="TimitCorpusReader.play"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.TimitCorpusReader.play">[docs]</a>    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">utterance</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Play the given audio sample.</span>

<span class="sd">        :param utterance: The utterance id of the sample to play</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Method 1: os audio dev.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">ossaudiodev</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dsp</span> <span class="o">=</span> <span class="n">ossaudiodev</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">dsp</span><span class="o">.</span><span class="n">setfmt</span><span class="p">(</span><span class="n">ossaudiodev</span><span class="o">.</span><span class="n">AFMT_S16_LE</span><span class="p">)</span>
                <span class="n">dsp</span><span class="o">.</span><span class="n">channels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">dsp</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="mi">16000</span><span class="p">)</span>
                <span class="n">dsp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">audiodata</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
                <span class="n">dsp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IOError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;can&#39;t acquire the audio device; please &quot;</span>
                                     <span class="s">&quot;activate your audio device.&quot;</span><span class="p">)</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;system error message:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c"># Method 2: pygame</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">pygame.mixer</span><span class="o">,</span> <span class="nn">StringIO</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="mi">16000</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">StringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">(</span><span class="n">utterance</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>
            <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">Sound</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">pygame</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">get_busy</span><span class="p">():</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c"># Method 3: complain. :)</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="p">(</span><span class="s">&quot;you must install pygame or ossaudiodev &quot;</span>
                             <span class="s">&quot;for audio playback.&quot;</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="SpeakerInfo"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.SpeakerInfo">[docs]</a><span class="k">class</span> <span class="nc">SpeakerInfo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">sex</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="n">use</span><span class="p">,</span> <span class="n">recdate</span><span class="p">,</span> <span class="n">birthdate</span><span class="p">,</span>
                 <span class="n">ht</span><span class="p">,</span> <span class="n">race</span><span class="p">,</span> <span class="n">edu</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sex</span> <span class="o">=</span> <span class="n">sex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dr</span> <span class="o">=</span> <span class="n">dr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use</span> <span class="o">=</span> <span class="n">use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recdate</span> <span class="o">=</span> <span class="n">recdate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">birthdate</span> <span class="o">=</span> <span class="n">birthdate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ht</span> <span class="o">=</span> <span class="n">ht</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">race</span> <span class="o">=</span> <span class="n">race</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edu</span> <span class="o">=</span> <span class="n">edu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comments</span> <span class="o">=</span> <span class="n">comments</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">attribs</span> <span class="o">=</span> <span class="s">&#39;id sex dr use recdate birthdate ht race edu comments&#39;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attribs</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&#39;SpeakerInfo(</span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="read_timit_block"><a class="viewcode-back" href="../../../../api/nltk.corpus.reader.html#nltk.corpus.reader.timit.read_timit_block">[docs]</a><span class="k">def</span> <span class="nf">read_timit_block</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Block reader for timit tagged sentences, which are preceded by a sentence</span>
<span class="sd">    number that will be ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="k">return</span> <span class="p">[]</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">sent</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">sent</span><span class="p">]</span></div>
</pre></div>

          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../news.html">NLTK News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installing NLTK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../data.html">Installing NLTK Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/nltk.html">nltk Package</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../../../../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../../../../genindex.html" title="General Index"
             >index</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2012, NLTK Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>