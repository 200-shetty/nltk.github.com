<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Metrics</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="metrics">
<h1 class="title">Metrics</h1>

<!-- Copyright (C) 2001-2015 NLTK Project -->
<!-- For license information, see LICENSE.TXT -->
<p>The <cite>nltk.metrics</cite> package provides a variety of <em>evaluation measures</em>
which can be used for a wide variety of NLP tasks.</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; from __future__ import print_function
&gt;&gt;&gt; from nltk.metrics import *
</pre>
</blockquote>
<div class="section" id="standard-ir-scores">
<h1>Standard IR Scores</h1>
<p>We can use standard scores from information retrieval to test the
performance of taggers, chunkers, etc.</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; reference = 'DET NN VB DET JJ NN NN IN DET NN'.split()
&gt;&gt;&gt; test    = 'DET VB VB DET NN NN NN IN DET NN'.split()
&gt;&gt;&gt; print(accuracy(reference, test))
0.8
</pre>
</blockquote>
<p>The following measures apply to sets:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; reference_set = set(reference)
&gt;&gt;&gt; test_set = set(test)
&gt;&gt;&gt; precision(reference_set, test_set)
1.0
&gt;&gt;&gt; print(recall(reference_set, test_set))
0.8
&gt;&gt;&gt; print(f_measure(reference_set, test_set))
0.88888888888...
</pre>
</blockquote>
<p>Measuring the likelihood of the data, given probability distributions:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; from nltk import FreqDist, MLEProbDist
&gt;&gt;&gt; pdist1 = MLEProbDist(FreqDist(&quot;aldjfalskfjaldsf&quot;))
&gt;&gt;&gt; pdist2 = MLEProbDist(FreqDist(&quot;aldjfalssjjlldss&quot;))
&gt;&gt;&gt; print(log_likelihood(['a', 'd'], [pdist1, pdist2]))
-2.7075187496...
</pre>
</blockquote>
</div>
<div class="section" id="distance-metrics">
<h1>Distance Metrics</h1>
<p>String edit distance (Levenshtein):</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; edit_distance(&quot;rain&quot;, &quot;shine&quot;)
3
</pre>
</blockquote>
<p>Other distance measures:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; s1 = set([1,2,3,4])
&gt;&gt;&gt; s2 = set([3,4,5])
&gt;&gt;&gt; binary_distance(s1, s2)
1.0
&gt;&gt;&gt; print(jaccard_distance(s1, s2))
0.6
&gt;&gt;&gt; print(masi_distance(s1, s2))
0.868...
</pre>
</blockquote>
</div>
<div class="section" id="miscellaneous-measures">
<h1>Miscellaneous Measures</h1>
<p>Rank Correlation works with two dictionaries mapping keys to ranks.
The dictionaries should have the same set of keys.</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; spearman_correlation({'e':1, 't':2, 'a':3}, {'e':1, 'a':2, 't':3})
0.5
</pre>
</blockquote>
<p>Windowdiff uses a sliding window in comparing two segmentations of the same input (e.g. tokenizations, chunkings).
Segmentations are represented using strings of zeros and ones.</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; s1 = &quot;000100000010&quot;
&gt;&gt;&gt; s2 = &quot;000010000100&quot;
&gt;&gt;&gt; s3 = &quot;100000010000&quot;
&gt;&gt;&gt; s4 = &quot;000000000000&quot;
&gt;&gt;&gt; s5 = &quot;111111111111&quot;
&gt;&gt;&gt; windowdiff(s1, s1, 3)
0.0
&gt;&gt;&gt; abs(windowdiff(s1, s2, 3) - 0.3)  &lt; 1e-6  # windowdiff(s1, s2, 3) == 0.3
True
&gt;&gt;&gt; abs(windowdiff(s2, s3, 3) - 0.8)  &lt; 1e-6  # windowdiff(s2, s3, 3) == 0.8
True
&gt;&gt;&gt; windowdiff(s1, s4, 3)
0.5
&gt;&gt;&gt; windowdiff(s1, s5, 3)
1.0
</pre>
</blockquote>
</div>
<div class="section" id="confusion-matrix">
<h1>Confusion Matrix</h1>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; reference = 'This is the reference data.  Testing 123.  aoaeoeoe'
&gt;&gt;&gt; test =      'Thos iz_the rifirenci data.  Testeng 123.  aoaeoeoe'
&gt;&gt;&gt; print(ConfusionMatrix(reference, test))
  |   . 1 2 3 T _ a c d e f g h i n o r s t z |
--+-------------------------------------------+
  |&lt;8&gt;. . . . . 1 . . . . . . . . . . . . . . |
. | .&lt;2&gt;. . . . . . . . . . . . . . . . . . . |
1 | . .&lt;1&gt;. . . . . . . . . . . . . . . . . . |
2 | . . .&lt;1&gt;. . . . . . . . . . . . . . . . . |
3 | . . . .&lt;1&gt;. . . . . . . . . . . . . . . . |
T | . . . . .&lt;2&gt;. . . . . . . . . . . . . . . |
_ | . . . . . .&lt;.&gt;. . . . . . . . . . . . . . |
a | . . . . . . .&lt;4&gt;. . . . . . . . . . . . . |
c | . . . . . . . .&lt;1&gt;. . . . . . . . . . . . |
d | . . . . . . . . .&lt;1&gt;. . . . . . . . . . . |
e | . . . . . . . . . .&lt;6&gt;. . . 3 . . . . . . |
f | . . . . . . . . . . .&lt;1&gt;. . . . . . . . . |
g | . . . . . . . . . . . .&lt;1&gt;. . . . . . . . |
h | . . . . . . . . . . . . .&lt;2&gt;. . . . . . . |
i | . . . . . . . . . . 1 . . .&lt;1&gt;. 1 . . . . |
n | . . . . . . . . . . . . . . .&lt;2&gt;. . . . . |
o | . . . . . . . . . . . . . . . .&lt;3&gt;. . . . |
r | . . . . . . . . . . . . . . . . .&lt;2&gt;. . . |
s | . . . . . . . . . . . . . . . . . .&lt;2&gt;. 1 |
t | . . . . . . . . . . . . . . . . . . .&lt;3&gt;. |
z | . . . . . . . . . . . . . . . . . . . .&lt;.&gt;|
--+-------------------------------------------+
(row = reference; col = test)
&lt;BLANKLINE&gt;
</pre>
<pre class="doctest-block">
&gt;&gt;&gt; cm = ConfusionMatrix(reference, test)
&gt;&gt;&gt; print(cm.pretty_format(sort_by_count=True))
  |   e a i o s t . T h n r 1 2 3 c d f g _ z |
--+-------------------------------------------+
  |&lt;8&gt;. . . . . . . . . . . . . . . . . . 1 . |
e | .&lt;6&gt;. 3 . . . . . . . . . . . . . . . . . |
a | . .&lt;4&gt;. . . . . . . . . . . . . . . . . . |
i | . 1 .&lt;1&gt;1 . . . . . . . . . . . . . . . . |
o | . . . .&lt;3&gt;. . . . . . . . . . . . . . . . |
s | . . . . .&lt;2&gt;. . . . . . . . . . . . . . 1 |
t | . . . . . .&lt;3&gt;. . . . . . . . . . . . . . |
. | . . . . . . .&lt;2&gt;. . . . . . . . . . . . . |
T | . . . . . . . .&lt;2&gt;. . . . . . . . . . . . |
h | . . . . . . . . .&lt;2&gt;. . . . . . . . . . . |
n | . . . . . . . . . .&lt;2&gt;. . . . . . . . . . |
r | . . . . . . . . . . .&lt;2&gt;. . . . . . . . . |
1 | . . . . . . . . . . . .&lt;1&gt;. . . . . . . . |
2 | . . . . . . . . . . . . .&lt;1&gt;. . . . . . . |
3 | . . . . . . . . . . . . . .&lt;1&gt;. . . . . . |
c | . . . . . . . . . . . . . . .&lt;1&gt;. . . . . |
d | . . . . . . . . . . . . . . . .&lt;1&gt;. . . . |
f | . . . . . . . . . . . . . . . . .&lt;1&gt;. . . |
g | . . . . . . . . . . . . . . . . . .&lt;1&gt;. . |
_ | . . . . . . . . . . . . . . . . . . .&lt;.&gt;. |
z | . . . . . . . . . . . . . . . . . . . .&lt;.&gt;|
--+-------------------------------------------+
(row = reference; col = test)
&lt;BLANKLINE&gt;
</pre>
<pre class="doctest-block">
&gt;&gt;&gt; print(cm.pretty_format(sort_by_count=True, truncate=10))
  |   e a i o s t . T h |
--+---------------------+
  |&lt;8&gt;. . . . . . . . . |
e | .&lt;6&gt;. 3 . . . . . . |
a | . .&lt;4&gt;. . . . . . . |
i | . 1 .&lt;1&gt;1 . . . . . |
o | . . . .&lt;3&gt;. . . . . |
s | . . . . .&lt;2&gt;. . . . |
t | . . . . . .&lt;3&gt;. . . |
. | . . . . . . .&lt;2&gt;. . |
T | . . . . . . . .&lt;2&gt;. |
h | . . . . . . . . .&lt;2&gt;|
--+---------------------+
(row = reference; col = test)
&lt;BLANKLINE&gt;
</pre>
<pre class="doctest-block">
&gt;&gt;&gt; print(cm.pretty_format(sort_by_count=True, truncate=10, values_in_chart=False))
   |                   1 |
   | 1 2 3 4 5 6 7 8 9 0 |
---+---------------------+
 1 |&lt;8&gt;. . . . . . . . . |
 2 | .&lt;6&gt;. 3 . . . . . . |
 3 | . .&lt;4&gt;. . . . . . . |
 4 | . 1 .&lt;1&gt;1 . . . . . |
 5 | . . . .&lt;3&gt;. . . . . |
 6 | . . . . .&lt;2&gt;. . . . |
 7 | . . . . . .&lt;3&gt;. . . |
 8 | . . . . . . .&lt;2&gt;. . |
 9 | . . . . . . . .&lt;2&gt;. |
10 | . . . . . . . . .&lt;2&gt;|
---+---------------------+
(row = reference; col = test)
Value key:
     1:
     2: e
     3: a
     4: i
     5: o
     6: s
     7: t
     8: .
     9: T
    10: h
&lt;BLANKLINE&gt;
</pre>
</blockquote>
</div>
<div class="section" id="association-measures">
<h1>Association measures</h1>
<p>These measures are useful to determine whether the coocurrence of two random
events is meaningful. They are used, for instance, to distinguish collocations
from other pairs of adjacent words.</p>
<p>We bring some examples of bigram association calculations from Manning and
Schutze's SNLP, 2nd Ed. chapter 5.</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; n_new_companies, n_new, n_companies, N = 8, 15828, 4675, 14307668
&gt;&gt;&gt; bam = BigramAssocMeasures
&gt;&gt;&gt; bam.raw_freq(20, (42, 20), N) == 20. / N
True
&gt;&gt;&gt; bam.student_t(n_new_companies, (n_new, n_companies), N)
0.999...
&gt;&gt;&gt; bam.chi_sq(n_new_companies, (n_new, n_companies), N)
1.54...
&gt;&gt;&gt; bam.likelihood_ratio(150, (12593, 932), N)
1291...
</pre>
</blockquote>
<p>For other associations, we ensure the ordering of the measures:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; bam.mi_like(20, (42, 20), N) &gt; bam.mi_like(20, (41, 27), N)
True
&gt;&gt;&gt; bam.pmi(20, (42, 20), N) &gt; bam.pmi(20, (41, 27), N)
True
&gt;&gt;&gt; bam.phi_sq(20, (42, 20), N) &gt; bam.phi_sq(20, (41, 27), N)
True
&gt;&gt;&gt; bam.poisson_stirling(20, (42, 20), N) &gt; bam.poisson_stirling(20, (41, 27), N)
True
&gt;&gt;&gt; bam.jaccard(20, (42, 20), N) &gt; bam.jaccard(20, (41, 27), N)
True
&gt;&gt;&gt; bam.dice(20, (42, 20), N) &gt; bam.dice(20, (41, 27), N)
True
&gt;&gt;&gt; bam.fisher(20, (42, 20), N) &gt; bam.fisher(20, (41, 27), N)
False
</pre>
</blockquote>
<p>For trigrams, we have to provide more count information:</p>
<blockquote>
<pre class="doctest-block">
&gt;&gt;&gt; n_w1_w2_w3 = 20
&gt;&gt;&gt; n_w1_w2, n_w1_w3, n_w2_w3 = 35, 60, 40
&gt;&gt;&gt; pair_counts = (n_w1_w2, n_w1_w3, n_w2_w3)
&gt;&gt;&gt; n_w1, n_w2, n_w3 = 100, 200, 300
&gt;&gt;&gt; uni_counts = (n_w1, n_w2, n_w3)
&gt;&gt;&gt; N = 14307668
&gt;&gt;&gt; tam = TrigramAssocMeasures
&gt;&gt;&gt; tam.raw_freq(n_w1_w2_w3, pair_counts, uni_counts, N) == 1. * n_w1_w2_w3 / N
True
&gt;&gt;&gt; uni_counts2 = (n_w1, n_w2, 100)
&gt;&gt;&gt; tam.student_t(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.student_t(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.chi_sq(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.chi_sq(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.mi_like(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.mi_like(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.pmi(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.pmi(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.likelihood_ratio(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.likelihood_ratio(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.poisson_stirling(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.poisson_stirling(n_w1_w2_w3, pair_counts, uni_counts, N)
True
&gt;&gt;&gt; tam.jaccard(n_w1_w2_w3, pair_counts, uni_counts2, N) &gt; tam.jaccard(n_w1_w2_w3, pair_counts, uni_counts, N)
True
</pre>
</blockquote>
</div>
</div>
</body>
</html>
