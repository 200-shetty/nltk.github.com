<?xml version="1.0" encoding="ascii" ?>

<script language="javascript" type="text/javascript">

function astext(node)
{
    return node.innerHTML.replace(/(<([^>]+)>)/ig,"")
                         .replace(/&gt;/ig, ">")
                         .replace(/&lt;/ig, "<")
                         .replace(/&quot;/ig, '"')
                         .replace(/&amp;/ig, "&");
}

function copy_notify(node, bar_color, data)
{
    // The outer box: relative + inline positioning.
    var box1 = document.createElement("div");
    box1.style.position = "relative";
    box1.style.display = "inline";
    box1.style.top = "2em";
    box1.style.left = "1em";
  
    // A shadow for fun
    var shadow = document.createElement("div");
    shadow.style.position = "absolute";
    shadow.style.left = "-1.3em";
    shadow.style.top = "-1.3em";
    shadow.style.background = "#404040";
    
    // The inner box: absolute positioning.
    var box2 = document.createElement("div");
    box2.style.position = "relative";
    box2.style.border = "1px solid #a0a0a0";
    box2.style.left = "-.2em";
    box2.style.top = "-.2em";
    box2.style.background = "white";
    box2.style.padding = ".3em .4em .3em .4em";
    box2.style.fontStyle = "normal";
    box2.style.background = "#f0e0e0";

    node.insertBefore(box1, node.childNodes.item(0));
    box1.appendChild(shadow);
    shadow.appendChild(box2);
    box2.innerHTML="Copied&nbsp;to&nbsp;the&nbsp;clipboard: " +
                   "<pre class='copy-notify'>"+
                   data+"</pre>";
    setTimeout(function() { node.removeChild(box1); }, 1000);

    var elt = node.parentNode.firstChild;
    elt.style.background = "#ffc0c0";
    setTimeout(function() { elt.style.background = bar_color; }, 200);
}

function copy_codeblock_to_clipboard(node)
{
    var data = astext(node)+"\n";
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#40a060", data);
    }
}

function copy_doctest_to_clipboard(node)
{
    var s = astext(node)+"\n   ";
    var data = "";

    var start = 0;
    var end = s.indexOf("\n");
    while (end >= 0) {
        if (s.substring(start, start+4) == ">>> ") {
            data += s.substring(start+4, end+1);
        }
        else if (s.substring(start, start+4) == "... ") {
            data += s.substring(start+4, end+1);
        }
        /*
        else if (end-start > 1) {
            data += "# " + s.substring(start, end+1);
        }*/
        // Grab the next line.
        start = end+1;
        end = s.indexOf("\n", start);
    }
    
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#4060a0", data);
    }
}
    
function copy_text_to_clipboard(data)
{
    if (window.clipboardData) {
        window.clipboardData.setData("Text", data);
        return true;
     }
    else if (window.netscape) {
        // w/ default firefox settings, permission will be denied for this:
        netscape.security.PrivilegeManager
                      .enablePrivilege("UniversalXPConnect");
    
        var clip = Components.classes["@mozilla.org/widget/clipboard;1"]
                      .createInstance(Components.interfaces.nsIClipboard);
        if (!clip) return;
    
        var trans = Components.classes["@mozilla.org/widget/transferable;1"]
                       .createInstance(Components.interfaces.nsITransferable);
        if (!trans) return;
    
        trans.addDataFlavor("text/unicode");
    
        var str = new Object();
        var len = new Object();
    
        var str = Components.classes["@mozilla.org/supports-string;1"]
                     .createInstance(Components.interfaces.nsISupportsString);
        var datacopy=data;
        str.data=datacopy;
        trans.setTransferData("text/unicode",str,datacopy.length*2);
        var clipid=Components.interfaces.nsIClipboard;
    
        if (!clip) return false;
    
        clip.setData(trans,null,clipid.kGlobalClipboard);
        return true;
    }
    return false;
}
//-->
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ascii" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Parsing</title>
<style type="text/css">

/*
:Author: Edward Loper, James Curran
:Copyright: This stylesheet has been placed in the public domain.

Stylesheet for use with Docutils.

This stylesheet defines new css classes used by NLTK.

It uses a Python syntax highlighting scheme that matches
the colour scheme used by IDLE, which makes it easier for
beginners to check they are typing things in correctly.
*/

/* Include the standard docutils stylesheet. */
@import url(default.css);

/* Custom inline roles */
span.placeholder    { font-style: italic; font-family: monospace; }
span.example        { font-style: italic; }
span.emphasis       { font-style: italic; }
span.termdef        { font-weight: bold; }
/*span.term           { font-style: italic; }*/
span.category       { font-variant: small-caps; }
span.feature        { font-variant: small-caps; }
span.fval           { font-style: italic; }
span.math           { font-style: italic; }
span.mathit         { font-style: italic; }
span.lex            { font-variant: small-caps; }
span.guide-linecount{ text-align: right; display: block;}

/* Python souce code listings */
span.pysrc-prompt   { color: #9b0000; }
span.pysrc-more     { color: #9b00ff; }
span.pysrc-keyword  { color: #e06000; }
span.pysrc-builtin  { color: #940094; }
span.pysrc-string   { color: #00aa00; }
span.pysrc-comment  { color: #ff0000; }
span.pysrc-output   { color: #0000ff; }
span.pysrc-except   { color: #ff0000; }
span.pysrc-defname  { color: #008080; }


/* Doctest blocks */
pre.doctest         { margin: 0; padding: 0; font-weight: bold; }
div.doctest         { margin: 0 1em 1em 1em; padding: 0; }
table.doctest       { margin: 0; padding: 0;
                      border-top: 1px solid gray;
                      border-bottom: 1px solid gray; }
pre.copy-notify     { margin: 0; padding: 0.2em; font-weight: bold;
                      background-color: #ffffff; }

/* Python source listings */
div.pylisting       { margin: 0 1em 1em 1em; padding: 0; }
table.pylisting     { margin: 0; padding: 0;
                      border-top: 1px solid gray; }
td.caption { border-top: 1px solid black; margin: 0; padding: 0; }
.caption-label { font-weight: bold;  }
td.caption p { margin: 0; padding: 0; font-style: normal;}

table tr td.codeblock { 
  padding: 0.2em ! important; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeffee;
}

table tr td.doctest  { 
  padding: 0.2em; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeeeff;
}

td.codeblock table tr td.copybar {
    background: #40a060; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }
td.doctest table tr td.copybar {
    background: #4060a0; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }

td.pysrc { padding-left: 0.5em; }

img.callout { border-width: 0px; }

table.docutils {
    border-style: solid;
    border-width: 1px;
    margin-top: 6px;
    border-color: grey;
    border-collapse: collapse; }

table.docutils th {
    border-style: none;
    border-width: 1px;
    border-color: grey;
    padding: 0 .5em 0 .5em; }

table.docutils td {
    border-style: none;
    border-width: 1px;
    border-color: grey; 
    padding: 0 .5em 0 .5em; }

table.footnote td { padding: 0; }
table.footnote { border-width: 0; }
table.footnote td { border-width: 0; }
table.footnote th { border-width: 0; }

table.noborder { border-width: 0; }

table.example pre { margin-top: 4px; margin-bottom: 0; }

/* For figures & tables */
p.caption { margin-bottom: 0; }
div.figure { text-align: center; }

/* The index */
div.index { border: 1px solid black;
            background-color: #eeeeee; }
div.index h1 { padding-left: 0.5em; margin-top: 0.5ex;
               border-bottom: 1px solid black; }
ul.index { margin-left: 0.5em; padding-left: 0; }
li.index { list-style-type: none; }
p.index-heading { font-size: 120%; font-style: italic; margin: 0; }
li.index ul { margin-left: 2em; padding-left: 0; }

/* 'Note' callouts */
div.note
{
  border-right:   #87ceeb 1px solid;
  padding-right: 4px;
  border-top: #87ceeb 1px solid;
  padding-left: 4px;
  padding-bottom: 4px;
  margin: 2px 5% 10px;
  border-left: #87ceeb 1px solid;
  padding-top: 4px;
  border-bottom: #87ceeb 1px solid;
  font-style: normal;
  font-family: verdana, arial;
  background-color: #b0c4de;
}

table.avm { border: 0px solid black; width: 0; }
table.avm tbody tr {border: 0px solid black; }
table.avm tbody tr td { padding: 2px; }
table.avm tbody tr td.avm-key { padding: 5px; font-variant: small-caps; }
table.avm tbody tr td.avm-eq { padding: 5px; }
table.avm tbody tr td.avm-val { padding: 5px; font-style: italic; }
p.avm-empty { font-style: normal; }
table.avm colgroup col { border: 0px solid black; }
table.avm tbody tr td.avm-topleft 
    { border-left: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botleft 
    { border-left: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-topright
    { border-right: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botright
    { border-right: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-left
    { border-left: 2px solid #000080; }
table.avm tbody tr td.avm-right
    { border-right: 2px solid #000080; }
table.avm tbody tr td.avm-topbotleft
    { border: 2px solid #000080; border-right: 0px solid black; }
table.avm tbody tr td.avm-topbotright
    { border: 2px solid #000080; border-left: 0px solid black; }
table.avm tbody tr td.avm-ident
    { font-size: 80%; padding: 0; padding-left: 2px; vertical-align: top; }
.avm-pointer
{ border: 1px solid #008000; padding: 1px; color: #008000; 
  background: #c0ffc0; font-style: normal; }

table.gloss { border: 0px solid black; width: 0; }
table.gloss tbody tr { border: 0px solid black; }
table.gloss tbody tr td { border: 0px solid black; }
table.gloss colgroup col { border: 0px solid black; }
table.gloss p { margin: 0; padding: 0; }

table.rst-example { border: 1px solid black; }
table.rst-example tbody tr td { background: #eeeeee; }
table.rst-example thead tr th { background: #c0ffff; }
td.rst-raw { width: 0; }

/* Used by nltk.org/doc/test: */
div.doctest-list { text-align: center; }
table.doctest-list { border: 1px solid black;
  margin-left: auto; margin-right: auto;
}
table.doctest-list tbody tr td { background: #eeeeee;
  border: 1px solid #cccccc; text-align: left; }
table.doctest-list thead tr th { background: #304050; color: #ffffff;
  border: 1px solid #000000;}
table.doctest-list thead tr a { color: #ffffff; }
span.doctest-passed { color: #008000; }
span.doctest-failed { color: #800000; }

</style>
</head>
<body>
<div class="document" id="parsing">
<h1 class="title">Parsing</h1>

<!-- Copyright (C) 2001-2014 NLTK Project -->
<!-- For license information, see LICENSE.TXT -->
<div class="section" id="unit-tests-for-the-context-free-grammar-class">
<h1>1&nbsp;&nbsp;&nbsp;Unit tests for the Context Free Grammar class</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk <span class="pysrc-keyword">import</span> Nonterminal, nonterminals, Production, CFG</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nt1 = Nonterminal(<span class="pysrc-string">'NP'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nt2 = Nonterminal(<span class="pysrc-string">'VP'</span>)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nt1.symbol()
<span class="pysrc-output">'NP'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nt1 == Nonterminal(<span class="pysrc-string">'NP'</span>)
<span class="pysrc-output">True</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nt1 == nt2
<span class="pysrc-output">False</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>S, NP, VP, PP = nonterminals(<span class="pysrc-string">'S, NP, VP, PP'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>N, V, P, DT = nonterminals(<span class="pysrc-string">'N, V, P, DT'</span>)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod1 = Production(S, [NP, VP])
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod2 = Production(NP, [DT, NP])</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod1.lhs()
<span class="pysrc-output">S</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod1.rhs()
<span class="pysrc-output">(NP, VP)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod1 == Production(S, [NP, VP])
<span class="pysrc-output">True</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod1 == prod2
<span class="pysrc-output">False</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = CFG.fromstring(<span class="pysrc-string">&quot;&quot;&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">S -&gt; NP VP</span>
<span class="pysrc-more">... </span><span class="pysrc-string">PP -&gt; P NP</span>
<span class="pysrc-more">... </span><span class="pysrc-string">NP -&gt; 'the' N | N PP | 'the' N PP</span>
<span class="pysrc-more">... </span><span class="pysrc-string">VP -&gt; V NP | V PP | V NP PP</span>
<span class="pysrc-more">... </span><span class="pysrc-string">N -&gt; 'cat'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">N -&gt; 'dog'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">N -&gt; 'rug'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">V -&gt; 'chased'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">V -&gt; 'sat'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">P -&gt; 'in'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">P -&gt; 'on'</span>
<span class="pysrc-more">... </span><span class="pysrc-string">&quot;&quot;&quot;</span>)</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-rd-recursive-descent-parser-class">
<h1>2&nbsp;&nbsp;&nbsp;Unit tests for the rd (Recursive Descent Parser) class</h1>
<p>Create and run a recursive descent parser over both a syntactically ambiguous
and unambiguous sentence.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.parse <span class="pysrc-keyword">import</span> RecursiveDescentParser
<span class="pysrc-prompt">&gt;&gt;&gt; </span>rd = RecursiveDescentParser(grammar)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentence1 = <span class="pysrc-string">'the cat chased the dog'</span>.split()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentence2 = <span class="pysrc-string">'the cat chased the dog on the rug'</span>.split()</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> rd.parse(sentence1):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S (NP the (N cat)) (VP (V chased) (NP the (N dog))))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> rd.parse(sentence2):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP the (N cat))</span>
<span class="pysrc-output">  (VP (V chased) (NP the (N dog) (PP (P on) (NP the (N rug))))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP the (N cat))</span>
<span class="pysrc-output">  (VP (V chased) (NP the (N dog)) (PP (P on) (NP the (N rug)))))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<dl class="docutils">
<dt>(dolist (expr doctest-font-lock-keywords)</dt>
<dd><p class="first">(add-to-list 'font-lock-keywords expr))</p>
<p class="last">font-lock-keywords</p>
</dd>
<dt>(add-to-list 'font-lock-keywords</dt>
<dd>(car doctest-font-lock-keywords))</dd>
</dl>
</div>
<div class="section" id="unit-tests-for-the-sr-shift-reduce-parser-class">
<h1>3&nbsp;&nbsp;&nbsp;Unit tests for the sr (Shift Reduce Parser) class</h1>
<p>Create and run a shift reduce parser over both a syntactically ambiguous
and unambiguous sentence. Note that unlike the recursive descent parser, one
and only one parse is ever returned.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.parse <span class="pysrc-keyword">import</span> ShiftReduceParser
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sr = ShiftReduceParser(grammar)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentence1 = <span class="pysrc-string">'the cat chased the dog'</span>.split()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentence2 = <span class="pysrc-string">'the cat chased the dog on the rug'</span>.split()</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> sr.parse(sentence1):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S (NP the (N cat)) (VP (V chased) (NP the (N dog))))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The shift reduce parser uses heuristics to decide what to do when there are
multiple possible shift or reduce operations available - for the supplied
grammar clearly the wrong operation is selected.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> sr.parse(sentence2):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-chart-parser-class">
<h1>4&nbsp;&nbsp;&nbsp;Unit tests for the Chart Parser class</h1>
<p>We use the demo() function for testing.
We must turn off showing of times.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> nltk</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>First we test tracing with a short sentence</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(2, print_times=False, trace=1,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw a dog'</span>, numparses=1)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw a dog</span>
<span class="pysrc-output">['I', 'saw', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Bottom-up</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">|.    I    .   saw   .    a    .   dog   .|</span>
<span class="pysrc-output">|[---------]         .         .         .| [0:1] 'I'</span>
<span class="pysrc-output">|.         [---------]         .         .| [1:2] 'saw'</span>
<span class="pysrc-output">|.         .         [---------]         .| [2:3] 'a'</span>
<span class="pysrc-output">|.         .         .         [---------]| [3:4] 'dog'</span>
<span class="pysrc-output">|&gt;         .         .         .         .| [0:0] NP -&gt; * 'I'</span>
<span class="pysrc-output">|[---------]         .         .         .| [0:1] NP -&gt; 'I' *</span>
<span class="pysrc-output">|&gt;         .         .         .         .| [0:0] S  -&gt; * NP VP</span>
<span class="pysrc-output">|&gt;         .         .         .         .| [0:0] NP -&gt; * NP PP</span>
<span class="pysrc-output">|[---------&gt;         .         .         .| [0:1] S  -&gt; NP * VP</span>
<span class="pysrc-output">|[---------&gt;         .         .         .| [0:1] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.         &gt;         .         .         .| [1:1] Verb -&gt; * 'saw'</span>
<span class="pysrc-output">|.         [---------]         .         .| [1:2] Verb -&gt; 'saw' *</span>
<span class="pysrc-output">|.         &gt;         .         .         .| [1:1] VP -&gt; * Verb NP</span>
<span class="pysrc-output">|.         &gt;         .         .         .| [1:1] VP -&gt; * Verb</span>
<span class="pysrc-output">|.         [---------&gt;         .         .| [1:2] VP -&gt; Verb * NP</span>
<span class="pysrc-output">|.         [---------]         .         .| [1:2] VP -&gt; Verb *</span>
<span class="pysrc-output">|.         &gt;         .         .         .| [1:1] VP -&gt; * VP PP</span>
<span class="pysrc-output">|[-------------------]         .         .| [0:2] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.         [---------&gt;         .         .| [1:2] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.         .         &gt;         .         .| [2:2] Det -&gt; * 'a'</span>
<span class="pysrc-output">|.         .         [---------]         .| [2:3] Det -&gt; 'a' *</span>
<span class="pysrc-output">|.         .         &gt;         .         .| [2:2] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|.         .         [---------&gt;         .| [2:3] NP -&gt; Det * Noun</span>
<span class="pysrc-output">|.         .         .         &gt;         .| [3:3] Noun -&gt; * 'dog'</span>
<span class="pysrc-output">|.         .         .         [---------]| [3:4] Noun -&gt; 'dog' *</span>
<span class="pysrc-output">|.         .         [-------------------]| [2:4] NP -&gt; Det Noun *</span>
<span class="pysrc-output">|.         .         &gt;         .         .| [2:2] S  -&gt; * NP VP</span>
<span class="pysrc-output">|.         .         &gt;         .         .| [2:2] NP -&gt; * NP PP</span>
<span class="pysrc-output">|.         [-----------------------------]| [1:4] VP -&gt; Verb NP *</span>
<span class="pysrc-output">|.         .         [-------------------&gt;| [2:4] S  -&gt; NP * VP</span>
<span class="pysrc-output">|.         .         [-------------------&gt;| [2:4] NP -&gt; NP * PP</span>
<span class="pysrc-output">|[=======================================]| [0:4] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.         [-----------------------------&gt;| [1:4] VP -&gt; VP * PP</span>
<span class="pysrc-output">Nr edges in chart: 33</span>
<span class="pysrc-output">(S (NP I) (VP (Verb saw) (NP (Det a) (Noun dog))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Then we test the different parsing Strategies.
Note that the number of edges differ between the strategies.</p>
<p>Top-down</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(1, print_times=False, trace=0,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Top-down</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Nr edges in chart: 48</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Bottom-up</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(2, print_times=False, trace=0,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Bottom-up</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Nr edges in chart: 53</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Bottom-up Left-Corner</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(3, print_times=False, trace=0,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Bottom-up left-corner</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Nr edges in chart: 36</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Left-Corner with Bottom-Up Filter</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(4, print_times=False, trace=0,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Filtered left-corner</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Nr edges in chart: 28</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The stepping chart parser</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.chart.demo(5, print_times=False, trace=1,
<span class="pysrc-more">... </span>                      sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* Strategy: Stepping (top-down vs bottom-up)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">*** SWITCH TO TOP DOWN</span>
<span class="pysrc-output">|[------]      .      .      .      .      .| [0:1] 'I'</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] 'saw'</span>
<span class="pysrc-output">|.      .      [------]      .      .      .| [2:3] 'John'</span>
<span class="pysrc-output">|.      .      .      [------]      .      .| [3:4] 'with'</span>
<span class="pysrc-output">|.      .      .      .      [------]      .| [4:5] 'a'</span>
<span class="pysrc-output">|.      .      .      .      .      [------]| [5:6] 'dog'</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] S  -&gt; * NP VP</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * NP PP</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * 'I'</span>
<span class="pysrc-output">|[------]      .      .      .      .      .| [0:1] NP -&gt; 'I' *</span>
<span class="pysrc-output">|[------&gt;      .      .      .      .      .| [0:1] S  -&gt; NP * VP</span>
<span class="pysrc-output">|[------&gt;      .      .      .      .      .| [0:1] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * VP PP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb NP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] Verb -&gt; * 'saw'</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] Verb -&gt; 'saw' *</span>
<span class="pysrc-output">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; Verb * NP</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] VP -&gt; Verb *</span>
<span class="pysrc-output">|[-------------]      .      .      .      .| [0:2] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; VP * PP</span>
<span class="pysrc-output">*** SWITCH TO BOTTOM UP</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * 'John'</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] PP -&gt; * 'with' NP</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] Prep -&gt; * 'with'</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] Det -&gt; * 'a'</span>
<span class="pysrc-output">|.      .      .      .      .      &gt;      .| [5:5] Noun -&gt; * 'dog'</span>
<span class="pysrc-output">|.      .      [------]      .      .      .| [2:3] NP -&gt; 'John' *</span>
<span class="pysrc-output">|.      .      .      [------&gt;      .      .| [3:4] PP -&gt; 'with' * NP</span>
<span class="pysrc-output">|.      .      .      [------]      .      .| [3:4] Prep -&gt; 'with' *</span>
<span class="pysrc-output">|.      .      .      .      [------]      .| [4:5] Det -&gt; 'a' *</span>
<span class="pysrc-output">|.      .      .      .      .      [------]| [5:6] Noun -&gt; 'dog' *</span>
<span class="pysrc-output">|.      [-------------]      .      .      .| [1:3] VP -&gt; Verb NP *</span>
<span class="pysrc-output">|[--------------------]      .      .      .| [0:3] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [-------------&gt;      .      .      .| [1:3] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] S  -&gt; * NP VP</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * NP PP</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|.      .      [------&gt;      .      .      .| [2:3] S  -&gt; NP * VP</span>
<span class="pysrc-output">|.      .      [------&gt;      .      .      .| [2:3] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      .      .      .      [------&gt;      .| [4:5] NP -&gt; Det * Noun</span>
<span class="pysrc-output">|.      .      .      .      [-------------]| [4:6] NP -&gt; Det Noun *</span>
<span class="pysrc-output">|.      .      .      [--------------------]| [3:6] PP -&gt; 'with' NP *</span>
<span class="pysrc-output">|.      [----------------------------------]| [1:6] VP -&gt; VP PP *</span>
<span class="pysrc-output">*** SWITCH TO TOP DOWN</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * NP PP</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * VP PP</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * Verb NP</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] VP -&gt; * Verb</span>
<span class="pysrc-output">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      .      [---------------------------]| [2:6] NP -&gt; NP PP *</span>
<span class="pysrc-output">|.      .      .      .      [-------------&gt;| [4:6] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      [----------------------------------]| [1:6] VP -&gt; Verb NP *</span>
<span class="pysrc-output">|.      .      [---------------------------&gt;| [2:6] S  -&gt; NP * VP</span>
<span class="pysrc-output">|.      .      [---------------------------&gt;| [2:6] NP -&gt; NP * PP</span>
<span class="pysrc-output">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * VP PP</span>
<span class="pysrc-output">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * Verb NP</span>
<span class="pysrc-output">|.      .      .      .      .      .      &gt;| [6:6] VP -&gt; * Verb</span>
<span class="pysrc-output">*** SWITCH TO BOTTOM UP</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] S  -&gt; * NP VP</span>
<span class="pysrc-output">|.      .      .      .      [-------------&gt;| [4:6] S  -&gt; NP * VP</span>
<span class="pysrc-output">*** SWITCH TO TOP DOWN</span>
<span class="pysrc-output">*** SWITCH TO BOTTOM UP</span>
<span class="pysrc-output">*** SWITCH TO TOP DOWN</span>
<span class="pysrc-output">*** SWITCH TO BOTTOM UP</span>
<span class="pysrc-output">*** SWITCH TO TOP DOWN</span>
<span class="pysrc-output">*** SWITCH TO BOTTOM UP</span>
<span class="pysrc-output">Nr edges in chart: 61</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-incremental-chart-parser-class">
<h1>5&nbsp;&nbsp;&nbsp;Unit tests for the Incremental Chart Parser class</h1>
<p>The incremental chart parsers are defined in earleychart.py.
We use the demo() function for testing. We must turn off showing of times.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> nltk</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Earley Chart Parser</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.earleychart.demo(print_times=False, trace=1,
<span class="pysrc-more">... </span>                            sent=<span class="pysrc-string">'I saw John with a dog'</span>, numparses=2)
<span class="pysrc-output">* Sentence:</span>
<span class="pysrc-output">I saw John with a dog</span>
<span class="pysrc-output">['I', 'saw', 'John', 'with', 'a', 'dog']</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">|.  I   . saw  . John . with .  a   . dog  .|</span>
<span class="pysrc-output">|[------]      .      .      .      .      .| [0:1] 'I'</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] 'saw'</span>
<span class="pysrc-output">|.      .      [------]      .      .      .| [2:3] 'John'</span>
<span class="pysrc-output">|.      .      .      [------]      .      .| [3:4] 'with'</span>
<span class="pysrc-output">|.      .      .      .      [------]      .| [4:5] 'a'</span>
<span class="pysrc-output">|.      .      .      .      .      [------]| [5:6] 'dog'</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] S  -&gt; * NP VP</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * NP PP</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|&gt;      .      .      .      .      .      .| [0:0] NP -&gt; * 'I'</span>
<span class="pysrc-output">|[------]      .      .      .      .      .| [0:1] NP -&gt; 'I' *</span>
<span class="pysrc-output">|[------&gt;      .      .      .      .      .| [0:1] S  -&gt; NP * VP</span>
<span class="pysrc-output">|[------&gt;      .      .      .      .      .| [0:1] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * VP PP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb NP</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] VP -&gt; * Verb</span>
<span class="pysrc-output">|.      &gt;      .      .      .      .      .| [1:1] Verb -&gt; * 'saw'</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] Verb -&gt; 'saw' *</span>
<span class="pysrc-output">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; Verb * NP</span>
<span class="pysrc-output">|.      [------]      .      .      .      .| [1:2] VP -&gt; Verb *</span>
<span class="pysrc-output">|[-------------]      .      .      .      .| [0:2] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [------&gt;      .      .      .      .| [1:2] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * NP PP</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|.      .      &gt;      .      .      .      .| [2:2] NP -&gt; * 'John'</span>
<span class="pysrc-output">|.      .      [------]      .      .      .| [2:3] NP -&gt; 'John' *</span>
<span class="pysrc-output">|.      [-------------]      .      .      .| [1:3] VP -&gt; Verb NP *</span>
<span class="pysrc-output">|.      .      [------&gt;      .      .      .| [2:3] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      .      .      &gt;      .      .      .| [3:3] PP -&gt; * 'with' NP</span>
<span class="pysrc-output">|[--------------------]      .      .      .| [0:3] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [-------------&gt;      .      .      .| [1:3] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      .      .      [------&gt;      .      .| [3:4] PP -&gt; 'with' * NP</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * NP PP</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] NP -&gt; * Det Noun</span>
<span class="pysrc-output">|.      .      .      .      &gt;      .      .| [4:4] Det -&gt; * 'a'</span>
<span class="pysrc-output">|.      .      .      .      [------]      .| [4:5] Det -&gt; 'a' *</span>
<span class="pysrc-output">|.      .      .      .      [------&gt;      .| [4:5] NP -&gt; Det * Noun</span>
<span class="pysrc-output">|.      .      .      .      .      &gt;      .| [5:5] Noun -&gt; * 'dog'</span>
<span class="pysrc-output">|.      .      .      .      .      [------]| [5:6] Noun -&gt; 'dog' *</span>
<span class="pysrc-output">|.      .      .      .      [-------------]| [4:6] NP -&gt; Det Noun *</span>
<span class="pysrc-output">|.      .      .      [--------------------]| [3:6] PP -&gt; 'with' NP *</span>
<span class="pysrc-output">|.      .      .      .      [-------------&gt;| [4:6] NP -&gt; NP * PP</span>
<span class="pysrc-output">|.      .      [---------------------------]| [2:6] NP -&gt; NP PP *</span>
<span class="pysrc-output">|.      [----------------------------------]| [1:6] VP -&gt; VP PP *</span>
<span class="pysrc-output">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="pysrc-output">|.      [----------------------------------]| [1:6] VP -&gt; Verb NP *</span>
<span class="pysrc-output">|.      .      [---------------------------&gt;| [2:6] NP -&gt; NP * PP</span>
<span class="pysrc-output">|[=========================================]| [0:6] S  -&gt; NP VP *</span>
<span class="pysrc-output">|.      [----------------------------------&gt;| [1:6] VP -&gt; VP * PP</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (VP (Verb saw) (NP John)) (PP with (NP (Det a) (Noun dog)))))</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP I)</span>
<span class="pysrc-output">  (VP (Verb saw) (NP (NP John) (PP with (NP (Det a) (Noun dog))))))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-large-context-free-grammars">
<h1>6&nbsp;&nbsp;&nbsp;Unit tests for LARGE context-free grammars</h1>
<p>Reading the ATIS grammar.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = nltk.data.load(<span class="pysrc-string">'grammars/large_grammars/atis.cfg'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar
<span class="pysrc-output">&lt;Grammar with 5517 productions&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Reading the test sentences.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentences = nltk.data.load(<span class="pysrc-string">'grammars/large_grammars/atis_sentences.txt'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sentences = nltk.parse.util.extract_test_sentences(sentences)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>len(sentences)
<span class="pysrc-output">98</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>testsentence = sentences[22]
<span class="pysrc-prompt">&gt;&gt;&gt; </span>testsentence[0]
<span class="pysrc-output">['show', 'me', 'northwest', 'flights', 'to', 'detroit', '.']</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>testsentence[1]
<span class="pysrc-output">17</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>sentence = testsentence[0]</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Now we test all different parsing strategies.
Note that the number of edges differ between the strategies.</p>
<p>Bottom-up parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.BottomUpChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">7661</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Bottom-up Left-corner parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.BottomUpLeftCornerChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">4986</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Left-corner parsing with bottom-up filter.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.LeftCornerChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">1342</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Top-down parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.TopDownChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">28352</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Incremental Bottom-up parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.IncrementalBottomUpChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">7661</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Incremental Bottom-up Left-corner parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.IncrementalBottomUpLeftCornerChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">4986</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Incremental Left-corner parsing with bottom-up filter.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.IncrementalLeftCornerChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">1342</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Incremental Top-down parsing.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.IncrementalTopDownChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">28352</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Earley parsing. This is similar to the incremental top-down algorithm.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = nltk.parse.EarleyChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>chart = parser.chart_parse(sentence)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((chart.num_edges()))
<span class="pysrc-output">28352</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((len(list(chart.parses(grammar.start())))))
<span class="pysrc-output">17</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-probabilistic-cfg-class">
<h1>7&nbsp;&nbsp;&nbsp;Unit tests for the Probabilistic CFG class</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.corpus <span class="pysrc-keyword">import</span> treebank
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> itertools <span class="pysrc-keyword">import</span> islice
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.grammar <span class="pysrc-keyword">import</span> PCFG, induce_pcfg, toy_pcfg1, toy_pcfg2</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Create a set of PCFG productions.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = PCFG.fromstring(<span class="pysrc-string">&quot;&quot;&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">A -&gt; B B [.3] | C B C [.7]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">B -&gt; B D [.5] | C [.5]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">C -&gt; 'a' [.1] | 'b' [0.9]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">D -&gt; 'b' [1.0]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">&quot;&quot;&quot;</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod = grammar.productions()[0]
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod
<span class="pysrc-output">A -&gt; B B [0.3]</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod.lhs()
<span class="pysrc-output">A</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>prod.rhs()
<span class="pysrc-output">(B, B)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((prod.prob()))
<span class="pysrc-output">0.3</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar.start()
<span class="pysrc-output">A</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar.productions()
<span class="pysrc-output">[A -&gt; B B [0.3], A -&gt; C B C [0.7], B -&gt; B D [0.5], B -&gt; C [0.5], C -&gt; 'a' [0.1], C -&gt; 'b' [0.9], D -&gt; 'b' [1]]</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Induce some productions using parsed Treebank data.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>productions = []
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> fileid <span class="pysrc-keyword">in</span> treebank.fileids()[:2]:
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> treebank.parsed_sents(fileid):
<span class="pysrc-more">... </span>        productions += t.productions()</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = induce_pcfg(S, productions)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar
<span class="pysrc-output">&lt;Grammar with 71 productions&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>sorted(grammar.productions(lhs=Nonterminal(<span class="pysrc-string">'PP'</span>)))[:2]
<span class="pysrc-output">[PP -&gt; IN NP [1]]</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>sorted(grammar.productions(lhs=Nonterminal(<span class="pysrc-string">'NNP'</span>)))[:2]
<span class="pysrc-output">[NNP -&gt; 'Agnew' [0.0714286], NNP -&gt; 'Consolidated' [0.0714286]]</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>sorted(grammar.productions(lhs=Nonterminal(<span class="pysrc-string">'JJ'</span>)))[:2]
<span class="pysrc-output">[JJ -&gt; 'British' [0.142857], JJ -&gt; 'former' [0.142857]]</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>sorted(grammar.productions(lhs=Nonterminal(<span class="pysrc-string">'NP'</span>)))[:2]
<span class="pysrc-output">[NP -&gt; CD NNS [0.133333], NP -&gt; DT JJ JJ NN [0.0666667]]</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-probabilistic-chart-parse-classes">
<h1>8&nbsp;&nbsp;&nbsp;Unit tests for the Probabilistic Chart Parse classes</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tokens = <span class="pysrc-string">&quot;Jack saw Bob with my cookie&quot;</span>.split()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = toy_pcfg2
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(grammar)
<span class="pysrc-output">Grammar with 23 productions (start state = S)</span>
<span class="pysrc-output">    S -&gt; NP VP [1]</span>
<span class="pysrc-output">    VP -&gt; V NP [0.59]</span>
<span class="pysrc-output">    VP -&gt; V [0.4]</span>
<span class="pysrc-output">    VP -&gt; VP PP [0.01]</span>
<span class="pysrc-output">    NP -&gt; Det N [0.41]</span>
<span class="pysrc-output">    NP -&gt; Name [0.28]</span>
<span class="pysrc-output">    NP -&gt; NP PP [0.31]</span>
<span class="pysrc-output">    PP -&gt; P NP [1]</span>
<span class="pysrc-output">    V -&gt; 'saw' [0.21]</span>
<span class="pysrc-output">    V -&gt; 'ate' [0.51]</span>
<span class="pysrc-output">    V -&gt; 'ran' [0.28]</span>
<span class="pysrc-output">    N -&gt; 'boy' [0.11]</span>
<span class="pysrc-output">    N -&gt; 'cookie' [0.12]</span>
<span class="pysrc-output">    N -&gt; 'table' [0.13]</span>
<span class="pysrc-output">    N -&gt; 'telescope' [0.14]</span>
<span class="pysrc-output">    N -&gt; 'hill' [0.5]</span>
<span class="pysrc-output">    Name -&gt; 'Jack' [0.52]</span>
<span class="pysrc-output">    Name -&gt; 'Bob' [0.48]</span>
<span class="pysrc-output">    P -&gt; 'with' [0.61]</span>
<span class="pysrc-output">    P -&gt; 'under' [0.39]</span>
<span class="pysrc-output">    Det -&gt; 'the' [0.41]</span>
<span class="pysrc-output">    Det -&gt; 'a' [0.31]</span>
<span class="pysrc-output">    Det -&gt; 'my' [0.28]</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Create several parsers using different queuing strategies and show the
resulting parses.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.parse <span class="pysrc-keyword">import</span> pchart</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = pchart.InsideChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (V saw)</span>
<span class="pysrc-output">    (NP</span>
<span class="pysrc-output">      (NP (Name Bob))</span>
<span class="pysrc-output">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (VP (V saw) (NP (Name Bob)))</span>
<span class="pysrc-output">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = pchart.RandomChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (V saw)</span>
<span class="pysrc-output">    (NP</span>
<span class="pysrc-output">      (NP (Name Bob))</span>
<span class="pysrc-output">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (VP (V saw) (NP (Name Bob)))</span>
<span class="pysrc-output">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = pchart.UnsortedChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (V saw)</span>
<span class="pysrc-output">    (NP</span>
<span class="pysrc-output">      (NP (Name Bob))</span>
<span class="pysrc-output">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (VP (V saw) (NP (Name Bob)))</span>
<span class="pysrc-output">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = pchart.LongestChartParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (V saw)</span>
<span class="pysrc-output">    (NP</span>
<span class="pysrc-output">      (NP (Name Bob))</span>
<span class="pysrc-output">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span>
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (VP (V saw) (NP (Name Bob)))</span>
<span class="pysrc-output">    (PP (P with) (NP (Det my) (N cookie))))) (p=2.03744e-07)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = pchart.InsideChartParser(grammar, beam_size = len(tokens)+1)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-viterbi-parse-classes">
<h1>9&nbsp;&nbsp;&nbsp;Unit tests for the Viterbi Parse classes</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.parse <span class="pysrc-keyword">import</span> ViterbiParser
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tokens = <span class="pysrc-string">&quot;Jack saw Bob with my cookie&quot;</span>.split()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = toy_pcfg2</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Parse the tokenized sentence.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = ViterbiParser(grammar)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> t <span class="pysrc-keyword">in</span> parser.parse(tokens):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(t)
<span class="pysrc-output">(S</span>
<span class="pysrc-output">  (NP (Name Jack))</span>
<span class="pysrc-output">  (VP</span>
<span class="pysrc-output">    (V saw)</span>
<span class="pysrc-output">    (NP</span>
<span class="pysrc-output">      (NP (Name Bob))</span>
<span class="pysrc-output">      (PP (P with) (NP (Det my) (N cookie)))))) (p=6.31607e-06)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-featstructnonterminal-class">
<h1>10&nbsp;&nbsp;&nbsp;Unit tests for the FeatStructNonterminal class</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.grammar <span class="pysrc-keyword">import</span> FeatStructNonterminal
<span class="pysrc-prompt">&gt;&gt;&gt; </span>FeatStructNonterminal(
<span class="pysrc-more">... </span>    pos=<span class="pysrc-string">'n'</span>, agr=FeatStructNonterminal(number=<span class="pysrc-string">'pl'</span>, gender=<span class="pysrc-string">'f'</span>))
<span class="pysrc-output">[agr=[gender='f', number='pl'], pos='n']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>FeatStructNonterminal(<span class="pysrc-string">'VP[+fin]/NP[+pl]'</span>)
<span class="pysrc-output">VP[+fin]/NP[+pl]</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="tracing-the-feature-chart-parser">
<h1>11&nbsp;&nbsp;&nbsp;Tracing the Feature Chart Parser</h1>
<p>We use the featurechart.demo() function for tracing the Feature Chart Parser.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.parse.featurechart.demo(print_times=False,
<span class="pysrc-more">... </span>                             print_grammar=True,
<span class="pysrc-more">... </span>                             parser=nltk.parse.featurechart.FeatureChartParser,
<span class="pysrc-more">... </span>                             sent=<span class="pysrc-string">'I saw John with a dog'</span>)
<span class="pysrc-output"></span>
<span class="pysrc-output">Grammar with 18 productions (start state = S[])</span>
<span class="pysrc-output">    S[] -&gt; NP[] VP[]</span>
<span class="pysrc-output">    PP[] -&gt; Prep[] NP[]</span>
<span class="pysrc-output">    NP[] -&gt; NP[] PP[]</span>
<span class="pysrc-output">    VP[] -&gt; VP[] PP[]</span>
<span class="pysrc-output">    VP[] -&gt; Verb[] NP[]</span>
<span class="pysrc-output">    VP[] -&gt; Verb[]</span>
<span class="pysrc-output">    NP[] -&gt; Det[pl=?x] Noun[pl=?x]</span>
<span class="pysrc-output">    NP[] -&gt; 'John'</span>
<span class="pysrc-output">    NP[] -&gt; 'I'</span>
<span class="pysrc-output">    Det[] -&gt; 'the'</span>
<span class="pysrc-output">    Det[] -&gt; 'my'</span>
<span class="pysrc-output">    Det[-pl] -&gt; 'a'</span>
<span class="pysrc-output">    Noun[-pl] -&gt; 'dog'</span>
<span class="pysrc-output">    Noun[-pl] -&gt; 'cookie'</span>
<span class="pysrc-output">    Verb[] -&gt; 'ate'</span>
<span class="pysrc-output">    Verb[] -&gt; 'saw'</span>
<span class="pysrc-output">    Prep[] -&gt; 'with'</span>
<span class="pysrc-output">    Prep[] -&gt; 'under'</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">* FeatureChartParser</span>
<span class="pysrc-output">Sentence: I saw John with a dog</span>
<span class="pysrc-output">|.I.s.J.w.a.d.|</span>
<span class="pysrc-output">|[-] . . . . .| [0:1] 'I'</span>
<span class="pysrc-output">|. [-] . . . .| [1:2] 'saw'</span>
<span class="pysrc-output">|. . [-] . . .| [2:3] 'John'</span>
<span class="pysrc-output">|. . . [-] . .| [3:4] 'with'</span>
<span class="pysrc-output">|. . . . [-] .| [4:5] 'a'</span>
<span class="pysrc-output">|. . . . . [-]| [5:6] 'dog'</span>
<span class="pysrc-output">|[-] . . . . .| [0:1] NP[] -&gt; 'I' *</span>
<span class="pysrc-output">|[-&gt; . . . . .| [0:1] S[] -&gt; NP[] * VP[] {}</span>
<span class="pysrc-output">|[-&gt; . . . . .| [0:1] NP[] -&gt; NP[] * PP[] {}</span>
<span class="pysrc-output">|. [-] . . . .| [1:2] Verb[] -&gt; 'saw' *</span>
<span class="pysrc-output">|. [-&gt; . . . .| [1:2] VP[] -&gt; Verb[] * NP[] {}</span>
<span class="pysrc-output">|. [-] . . . .| [1:2] VP[] -&gt; Verb[] *</span>
<span class="pysrc-output">|. [-&gt; . . . .| [1:2] VP[] -&gt; VP[] * PP[] {}</span>
<span class="pysrc-output">|[---] . . . .| [0:2] S[] -&gt; NP[] VP[] *</span>
<span class="pysrc-output">|. . [-] . . .| [2:3] NP[] -&gt; 'John' *</span>
<span class="pysrc-output">|. . [-&gt; . . .| [2:3] S[] -&gt; NP[] * VP[] {}</span>
<span class="pysrc-output">|. . [-&gt; . . .| [2:3] NP[] -&gt; NP[] * PP[] {}</span>
<span class="pysrc-output">|. [---] . . .| [1:3] VP[] -&gt; Verb[] NP[] *</span>
<span class="pysrc-output">|. [---&gt; . . .| [1:3] VP[] -&gt; VP[] * PP[] {}</span>
<span class="pysrc-output">|[-----] . . .| [0:3] S[] -&gt; NP[] VP[] *</span>
<span class="pysrc-output">|. . . [-] . .| [3:4] Prep[] -&gt; 'with' *</span>
<span class="pysrc-output">|. . . [-&gt; . .| [3:4] PP[] -&gt; Prep[] * NP[] {}</span>
<span class="pysrc-output">|. . . . [-] .| [4:5] Det[-pl] -&gt; 'a' *</span>
<span class="pysrc-output">|. . . . [-&gt; .| [4:5] NP[] -&gt; Det[pl=?x] * Noun[pl=?x] {?x: False}</span>
<span class="pysrc-output">|. . . . . [-]| [5:6] Noun[-pl] -&gt; 'dog' *</span>
<span class="pysrc-output">|. . . . [---]| [4:6] NP[] -&gt; Det[-pl] Noun[-pl] *</span>
<span class="pysrc-output">|. . . . [---&gt;| [4:6] S[] -&gt; NP[] * VP[] {}</span>
<span class="pysrc-output">|. . . . [---&gt;| [4:6] NP[] -&gt; NP[] * PP[] {}</span>
<span class="pysrc-output">|. . . [-----]| [3:6] PP[] -&gt; Prep[] NP[] *</span>
<span class="pysrc-output">|. . [-------]| [2:6] NP[] -&gt; NP[] PP[] *</span>
<span class="pysrc-output">|. [---------]| [1:6] VP[] -&gt; VP[] PP[] *</span>
<span class="pysrc-output">|. [---------&gt;| [1:6] VP[] -&gt; VP[] * PP[] {}</span>
<span class="pysrc-output">|[===========]| [0:6] S[] -&gt; NP[] VP[] *</span>
<span class="pysrc-output">|. . [-------&gt;| [2:6] S[] -&gt; NP[] * VP[] {}</span>
<span class="pysrc-output">|. . [-------&gt;| [2:6] NP[] -&gt; NP[] * PP[] {}</span>
<span class="pysrc-output">|. [---------]| [1:6] VP[] -&gt; Verb[] NP[] *</span>
<span class="pysrc-output">|. [---------&gt;| [1:6] VP[] -&gt; VP[] * PP[] {}</span>
<span class="pysrc-output">|[===========]| [0:6] S[] -&gt; NP[] VP[] *</span>
<span class="pysrc-output">(S[]</span>
<span class="pysrc-output">  (NP[] I)</span>
<span class="pysrc-output">  (VP[]</span>
<span class="pysrc-output">    (VP[] (Verb[] saw) (NP[] John))</span>
<span class="pysrc-output">    (PP[] (Prep[] with) (NP[] (Det[-pl] a) (Noun[-pl] dog)))))</span>
<span class="pysrc-output">(S[]</span>
<span class="pysrc-output">  (NP[] I)</span>
<span class="pysrc-output">  (VP[]</span>
<span class="pysrc-output">    (Verb[] saw)</span>
<span class="pysrc-output">    (NP[]</span>
<span class="pysrc-output">      (NP[] John)</span>
<span class="pysrc-output">      (PP[] (Prep[] with) (NP[] (Det[-pl] a) (Noun[-pl] dog))))))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="unit-tests-for-the-feature-chart-parser-classes">
<h1>12&nbsp;&nbsp;&nbsp;Unit tests for the Feature Chart Parser classes</h1>
<p>The list of parsers we want to test.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parsers = [nltk.parse.featurechart.FeatureChartParser,
<span class="pysrc-more">... </span>           nltk.parse.featurechart.FeatureTopDownChartParser,
<span class="pysrc-more">... </span>           nltk.parse.featurechart.FeatureBottomUpChartParser,
<span class="pysrc-more">... </span>           nltk.parse.featurechart.FeatureBottomUpLeftCornerChartParser,
<span class="pysrc-more">... </span>           nltk.parse.earleychart.FeatureIncrementalChartParser,
<span class="pysrc-more">... </span>           nltk.parse.earleychart.FeatureEarleyChartParser,
<span class="pysrc-more">... </span>           nltk.parse.earleychart.FeatureIncrementalTopDownChartParser,
<span class="pysrc-more">... </span>           nltk.parse.earleychart.FeatureIncrementalBottomUpChartParser,
<span class="pysrc-more">... </span>           nltk.parse.earleychart.FeatureIncrementalBottomUpLeftCornerChartParser,
<span class="pysrc-more">... </span>           ]</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>A helper function that tests each parser on the given grammar and sentence.
We check that the number of trees are correct, and that all parsers
return the same trees. Otherwise an error is printed.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">def</span> <span class="pysrc-defname">unittest</span>(grammar, sentence, nr_trees):
<span class="pysrc-more">... </span>    sentence = sentence.split()
<span class="pysrc-more">... </span>    trees = None
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">for</span> P <span class="pysrc-keyword">in</span> parsers:
<span class="pysrc-more">... </span>        result = P(grammar).parse(sentence)
<span class="pysrc-more">... </span>        result = set(tree.freeze() <span class="pysrc-keyword">for</span> tree <span class="pysrc-keyword">in</span> result)
<span class="pysrc-more">... </span>        <span class="pysrc-keyword">if</span> len(result) != nr_trees:
<span class="pysrc-more">... </span>            <span class="pysrc-keyword">print</span>(<span class="pysrc-string">&quot;Wrong nr of trees:&quot;</span>, len(result))
<span class="pysrc-more">... </span>        <span class="pysrc-keyword">elif</span> trees <span class="pysrc-keyword">is</span> None:
<span class="pysrc-more">... </span>            trees = result
<span class="pysrc-more">... </span>        <span class="pysrc-keyword">elif</span> result != trees:
<span class="pysrc-more">... </span>            <span class="pysrc-keyword">print</span>(<span class="pysrc-string">&quot;Trees differ for parser:&quot;</span>, P.__name__)</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The demo grammar from before, with an ambiguous sentence.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>isawjohn = nltk.parse.featurechart.demo_grammar()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>unittest(isawjohn, <span class="pysrc-string">&quot;I saw John with a dog with my cookie&quot;</span>, 5)</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>This grammar tests that variables in different grammar rules are renamed
before unification. (The problematic variable is in this case ?X).</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>whatwasthat = nltk.grammar.FeatureGrammar.fromstring(<span class="pysrc-string">'''</span>
<span class="pysrc-more">... </span><span class="pysrc-string">S[] -&gt; NP[num=?N] VP[num=?N, slash=?X]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">NP[num=?X] -&gt; &quot;what&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">NP[num=?X] -&gt; &quot;that&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">VP[num=?P, slash=none] -&gt; V[num=?P] NP[]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">V[num=sg] -&gt; &quot;was&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">'''</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>unittest(whatwasthat, <span class="pysrc-string">&quot;what was that&quot;</span>, 1)</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>This grammar tests that the same rule can be used in different places
in another rule, and that the variables are properly renamed.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>thislovesthat = nltk.grammar.FeatureGrammar.fromstring(<span class="pysrc-string">'''</span>
<span class="pysrc-more">... </span><span class="pysrc-string">S[] -&gt; NP[case=nom] V[] NP[case=acc]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">NP[case=?X] -&gt; Pron[case=?X]</span>
<span class="pysrc-more">... </span><span class="pysrc-string">Pron[] -&gt; &quot;this&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">Pron[] -&gt; &quot;that&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">V[] -&gt; &quot;loves&quot;</span>
<span class="pysrc-more">... </span><span class="pysrc-string">'''</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>unittest(thislovesthat, <span class="pysrc-string">&quot;this loves that&quot;</span>, 1)</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="tests-for-loading-feature-grammar-files">
<h1>13&nbsp;&nbsp;&nbsp;Tests for loading feature grammar files</h1>
<p>Alternative 1: first load the grammar, then create the parser.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>fcfg = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>fcp1 = nltk.parse.FeatureChartParser(fcfg)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((type(fcp1)))
<span class="pysrc-output">&lt;class 'nltk.parse.featurechart.FeatureChartParser'&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Alternative 2: directly load the parser.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>fcp2 = nltk.parse.load_parser(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>((type(fcp2)))
<span class="pysrc-output">&lt;class 'nltk.parse.featurechart.FeatureChartParser'&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
</div>
</body>
</html>
