<?xml version="1.0" encoding="ascii" ?>

<script language="javascript" type="text/javascript">

function astext(node)
{
    return node.innerHTML.replace(/(<([^>]+)>)/ig,"")
                         .replace(/&gt;/ig, ">")
                         .replace(/&lt;/ig, "<")
                         .replace(/&quot;/ig, '"')
                         .replace(/&amp;/ig, "&");
}

function copy_notify(node, bar_color, data)
{
    // The outer box: relative + inline positioning.
    var box1 = document.createElement("div");
    box1.style.position = "relative";
    box1.style.display = "inline";
    box1.style.top = "2em";
    box1.style.left = "1em";
  
    // A shadow for fun
    var shadow = document.createElement("div");
    shadow.style.position = "absolute";
    shadow.style.left = "-1.3em";
    shadow.style.top = "-1.3em";
    shadow.style.background = "#404040";
    
    // The inner box: absolute positioning.
    var box2 = document.createElement("div");
    box2.style.position = "relative";
    box2.style.border = "1px solid #a0a0a0";
    box2.style.left = "-.2em";
    box2.style.top = "-.2em";
    box2.style.background = "white";
    box2.style.padding = ".3em .4em .3em .4em";
    box2.style.fontStyle = "normal";
    box2.style.background = "#f0e0e0";

    node.insertBefore(box1, node.childNodes.item(0));
    box1.appendChild(shadow);
    shadow.appendChild(box2);
    box2.innerHTML="Copied&nbsp;to&nbsp;the&nbsp;clipboard: " +
                   "<pre class='copy-notify'>"+
                   data+"</pre>";
    setTimeout(function() { node.removeChild(box1); }, 1000);

    var elt = node.parentNode.firstChild;
    elt.style.background = "#ffc0c0";
    setTimeout(function() { elt.style.background = bar_color; }, 200);
}

function copy_codeblock_to_clipboard(node)
{
    var data = astext(node)+"\n";
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#40a060", data);
    }
}

function copy_doctest_to_clipboard(node)
{
    var s = astext(node)+"\n   ";
    var data = "";

    var start = 0;
    var end = s.indexOf("\n");
    while (end >= 0) {
        if (s.substring(start, start+4) == ">>> ") {
            data += s.substring(start+4, end+1);
        }
        else if (s.substring(start, start+4) == "... ") {
            data += s.substring(start+4, end+1);
        }
        /*
        else if (end-start > 1) {
            data += "# " + s.substring(start, end+1);
        }*/
        // Grab the next line.
        start = end+1;
        end = s.indexOf("\n", start);
    }
    
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#4060a0", data);
    }
}
    
function copy_text_to_clipboard(data)
{
    if (window.clipboardData) {
        window.clipboardData.setData("Text", data);
        return true;
     }
    else if (window.netscape) {
        // w/ default firefox settings, permission will be denied for this:
        netscape.security.PrivilegeManager
                      .enablePrivilege("UniversalXPConnect");
    
        var clip = Components.classes["@mozilla.org/widget/clipboard;1"]
                      .createInstance(Components.interfaces.nsIClipboard);
        if (!clip) return;
    
        var trans = Components.classes["@mozilla.org/widget/transferable;1"]
                       .createInstance(Components.interfaces.nsITransferable);
        if (!trans) return;
    
        trans.addDataFlavor("text/unicode");
    
        var str = new Object();
        var len = new Object();
    
        var str = Components.classes["@mozilla.org/supports-string;1"]
                     .createInstance(Components.interfaces.nsISupportsString);
        var datacopy=data;
        str.data=datacopy;
        trans.setTransferData("text/unicode",str,datacopy.length*2);
        var clipid=Components.interfaces.nsIClipboard;
    
        if (!clip) return false;
    
        clip.setData(trans,null,clipid.kGlobalClipboard);
        return true;
    }
    return false;
}
//-->
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ascii" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Loading Resources From the Data Package</title>
<style type="text/css">

/*
:Author: Edward Loper, James Curran
:Copyright: This stylesheet has been placed in the public domain.

Stylesheet for use with Docutils.

This stylesheet defines new css classes used by NLTK.

It uses a Python syntax highlighting scheme that matches
the colour scheme used by IDLE, which makes it easier for
beginners to check they are typing things in correctly.
*/

/* Include the standard docutils stylesheet. */
@import url(default.css);

/* Custom inline roles */
span.placeholder    { font-style: italic; font-family: monospace; }
span.example        { font-style: italic; }
span.emphasis       { font-style: italic; }
span.termdef        { font-weight: bold; }
/*span.term           { font-style: italic; }*/
span.category       { font-variant: small-caps; }
span.feature        { font-variant: small-caps; }
span.fval           { font-style: italic; }
span.math           { font-style: italic; }
span.mathit         { font-style: italic; }
span.lex            { font-variant: small-caps; }
span.guide-linecount{ text-align: right; display: block;}

/* Python souce code listings */
span.pysrc-prompt   { color: #9b0000; }
span.pysrc-more     { color: #9b00ff; }
span.pysrc-keyword  { color: #e06000; }
span.pysrc-builtin  { color: #940094; }
span.pysrc-string   { color: #00aa00; }
span.pysrc-comment  { color: #ff0000; }
span.pysrc-output   { color: #0000ff; }
span.pysrc-except   { color: #ff0000; }
span.pysrc-defname  { color: #008080; }


/* Doctest blocks */
pre.doctest         { margin: 0; padding: 0; font-weight: bold; }
div.doctest         { margin: 0 1em 1em 1em; padding: 0; }
table.doctest       { margin: 0; padding: 0;
                      border-top: 1px solid gray;
                      border-bottom: 1px solid gray; }
pre.copy-notify     { margin: 0; padding: 0.2em; font-weight: bold;
                      background-color: #ffffff; }

/* Python source listings */
div.pylisting       { margin: 0 1em 1em 1em; padding: 0; }
table.pylisting     { margin: 0; padding: 0;
                      border-top: 1px solid gray; }
td.caption { border-top: 1px solid black; margin: 0; padding: 0; }
.caption-label { font-weight: bold;  }
td.caption p { margin: 0; padding: 0; font-style: normal;}

table tr td.codeblock { 
  padding: 0.2em ! important; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeffee;
}

table tr td.doctest  { 
  padding: 0.2em; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeeeff;
}

td.codeblock table tr td.copybar {
    background: #40a060; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }
td.doctest table tr td.copybar {
    background: #4060a0; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }

td.pysrc { padding-left: 0.5em; }

img.callout { border-width: 0px; }

table.docutils {
    border-style: solid;
    border-width: 1px;
    margin-top: 6px;
    border-color: grey;
    border-collapse: collapse; }

table.docutils th {
    border-style: none;
    border-width: 1px;
    border-color: grey;
    padding: 0 .5em 0 .5em; }

table.docutils td {
    border-style: none;
    border-width: 1px;
    border-color: grey; 
    padding: 0 .5em 0 .5em; }

table.footnote td { padding: 0; }
table.footnote { border-width: 0; }
table.footnote td { border-width: 0; }
table.footnote th { border-width: 0; }

table.noborder { border-width: 0; }

table.example pre { margin-top: 4px; margin-bottom: 0; }

/* For figures & tables */
p.caption { margin-bottom: 0; }
div.figure { text-align: center; }

/* The index */
div.index { border: 1px solid black;
            background-color: #eeeeee; }
div.index h1 { padding-left: 0.5em; margin-top: 0.5ex;
               border-bottom: 1px solid black; }
ul.index { margin-left: 0.5em; padding-left: 0; }
li.index { list-style-type: none; }
p.index-heading { font-size: 120%; font-style: italic; margin: 0; }
li.index ul { margin-left: 2em; padding-left: 0; }

/* 'Note' callouts */
div.note
{
  border-right:   #87ceeb 1px solid;
  padding-right: 4px;
  border-top: #87ceeb 1px solid;
  padding-left: 4px;
  padding-bottom: 4px;
  margin: 2px 5% 10px;
  border-left: #87ceeb 1px solid;
  padding-top: 4px;
  border-bottom: #87ceeb 1px solid;
  font-style: normal;
  font-family: verdana, arial;
  background-color: #b0c4de;
}

table.avm { border: 0px solid black; width: 0; }
table.avm tbody tr {border: 0px solid black; }
table.avm tbody tr td { padding: 2px; }
table.avm tbody tr td.avm-key { padding: 5px; font-variant: small-caps; }
table.avm tbody tr td.avm-eq { padding: 5px; }
table.avm tbody tr td.avm-val { padding: 5px; font-style: italic; }
p.avm-empty { font-style: normal; }
table.avm colgroup col { border: 0px solid black; }
table.avm tbody tr td.avm-topleft 
    { border-left: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botleft 
    { border-left: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-topright
    { border-right: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botright
    { border-right: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-left
    { border-left: 2px solid #000080; }
table.avm tbody tr td.avm-right
    { border-right: 2px solid #000080; }
table.avm tbody tr td.avm-topbotleft
    { border: 2px solid #000080; border-right: 0px solid black; }
table.avm tbody tr td.avm-topbotright
    { border: 2px solid #000080; border-left: 0px solid black; }
table.avm tbody tr td.avm-ident
    { font-size: 80%; padding: 0; padding-left: 2px; vertical-align: top; }
.avm-pointer
{ border: 1px solid #008000; padding: 1px; color: #008000; 
  background: #c0ffc0; font-style: normal; }

table.gloss { border: 0px solid black; width: 0; }
table.gloss tbody tr { border: 0px solid black; }
table.gloss tbody tr td { border: 0px solid black; }
table.gloss colgroup col { border: 0px solid black; }
table.gloss p { margin: 0; padding: 0; }

table.rst-example { border: 1px solid black; }
table.rst-example tbody tr td { background: #eeeeee; }
table.rst-example thead tr th { background: #c0ffff; }
td.rst-raw { width: 0; }

/* Used by nltk.org/doc/test: */
div.doctest-list { text-align: center; }
table.doctest-list { border: 1px solid black;
  margin-left: auto; margin-right: auto;
}
table.doctest-list tbody tr td { background: #eeeeee;
  border: 1px solid #cccccc; text-align: left; }
table.doctest-list thead tr th { background: #304050; color: #ffffff;
  border: 1px solid #000000;}
table.doctest-list thead tr a { color: #ffffff; }
span.doctest-passed { color: #008000; }
span.doctest-failed { color: #800000; }

</style>
</head>
<body>
<div class="document" id="loading-resources-from-the-data-package">
<h1 class="title">Loading Resources From the Data Package</h1>

<!-- Copyright (C) 2001-2014 NLTK Project -->
<!-- For license information, see LICENSE.TXT -->
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> nltk.data</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="section" id="overview">
<h1>1&nbsp;&nbsp;&nbsp;Overview</h1>
<p>The <cite>nltk.data</cite> module contains functions that can be used to load
NLTK resource files, such as corpora, grammars, and saved processing
objects.</p>
</div>
<div class="section" id="loading-data-files">
<h1>2&nbsp;&nbsp;&nbsp;Loading Data Files</h1>
<p>Resources are loaded using the function <cite>nltk.data.load()</cite>, which
takes as its first argument a URL specifying what file should be
loaded.  The <tt class="doctest"><span class="pre">nltk:</span></tt> protocol loads files from the NLTK data
distribution:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> __future__ <span class="pysrc-keyword">import</span> print_function
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tokenizer = nltk.data.load(<span class="pysrc-string">'nltk:tokenizers/punkt/english.pickle'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tokenizer.tokenize(<span class="pysrc-string">'Hello.  This is a test.  It works!'</span>)
<span class="pysrc-output">['Hello.', 'This is a test.', 'It works!']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>It is important to note that there should be no space following the
colon (':') in the URL; 'nltk: tokenizers/punkt/english.pickle' will
not work!</p>
<p>The <tt class="doctest"><span class="pre">nltk:</span></tt> protocol is used by default if no protocol is specified:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.load(<span class="pysrc-string">'tokenizers/punkt/english.pickle'</span>) 
<span class="pysrc-output">&lt;nltk.tokenize.punkt.PunktSentenceTokenizer object at ...&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>But it is also possible to load resources from <tt class="doctest"><span class="pre">http:</span></tt>, <tt class="doctest"><span class="pre">ftp:</span></tt>,
and <tt class="doctest"><span class="pre">file:</span></tt> URLs, e.g. <tt class="doctest"><span class="pre">cfg = nltk.data.load(<span class="pysrc-string">'http://example.com/path/to/toy.cfg'</span>)</span></tt></p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Load a grammar using an absolute path.</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>url = <span class="pysrc-string">'file:%s'</span> % nltk.data.find(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>url.replace(<span class="pysrc-string">'\\', '</span>/') 
<span class="pysrc-output">'file:...toy.cfg'</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(nltk.data.load(url)) 
<span class="pysrc-output">Grammar with 14 productions (start state = S)</span>
<span class="pysrc-output">    S -&gt; NP VP</span>
<span class="pysrc-output">    PP -&gt; P NP</span>
<span class="pysrc-output">    ...</span>
<span class="pysrc-output">    P -&gt; 'on'</span>
<span class="pysrc-output">    P -&gt; 'in'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The second argument to the <cite>nltk.data.load()</cite> function specifies the
file format, which determines how the file's contents are processed
before they are returned by <tt class="doctest"><span class="pre">load()</span></tt>.  The formats that are
currently supported by the data module are described by the dictionary
<cite>nltk.data.FORMATS</cite>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> format, descr <span class="pysrc-keyword">in</span> sorted(nltk.data.FORMATS.items()):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(<span class="pysrc-string">'{0:&lt;7} {1:}'</span>.format(format, descr)) 
<span class="pysrc-output">cfg     A context free grammar.</span>
<span class="pysrc-output">fcfg    A feature CFG.</span>
<span class="pysrc-output">fol     A list of first order logic expressions, parsed with nltk.sem.logic.Expression.fromstring.</span>
<span class="pysrc-output">json    A serialized python object, stored using the json module.</span>
<span class="pysrc-output">logic   A list of first order logic expressions, parsed by nltk.sem.logic._LogicParser.  Requires an additional logic_parser parameter</span>
<span class="pysrc-output">pcfg    A probabilistic CFG.</span>
<span class="pysrc-output">pickle  A serialized python object, stored using the pickle module.</span>
<span class="pysrc-output">raw     The raw (byte string) contents of a file.</span>
<span class="pysrc-output">text    The raw (unicode string) contents of a file.</span>
<span class="pysrc-output">val     A semantic valuation, parsed by nltk.sem.parse_valuation().</span>
<span class="pysrc-output">yaml    A serialized python object, stored using the yaml module.</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p><cite>nltk.data.load()</cite> will raise a ValueError if a bad format name is
specified:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.load(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>, <span class="pysrc-string">'bar'</span>)
<span class="pysrc-except">Traceback (most recent call last):</span>
<span class="pysrc-except">  . . .</span>
<span class="pysrc-except">ValueError: Unknown format type!</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>By default, the <tt class="doctest"><span class="pre"><span class="pysrc-string">&quot;auto&quot;</span></span></tt> format is used, which chooses a format
based on the filename's extension.  The mapping from file extensions
to format names is specified by <cite>nltk.data.AUTO_FORMATS</cite>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> ext, format <span class="pysrc-keyword">in</span> sorted(nltk.data.AUTO_FORMATS.items()):
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(<span class="pysrc-string">'.%-7s -&gt; %s'</span> % (ext, format))
<span class="pysrc-output">.cfg     -&gt; cfg</span>
<span class="pysrc-output">.fcfg    -&gt; fcfg</span>
<span class="pysrc-output">.fol     -&gt; fol</span>
<span class="pysrc-output">    .json    -&gt; json</span>
<span class="pysrc-output">.logic   -&gt; logic</span>
<span class="pysrc-output">.pcfg    -&gt; pcfg</span>
<span class="pysrc-output">.pickle  -&gt; pickle</span>
<span class="pysrc-output">.text    -&gt; text</span>
<span class="pysrc-output">.txt     -&gt; text</span>
<span class="pysrc-output">.val     -&gt; val</span>
<span class="pysrc-output">.yaml    -&gt; yaml</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>If <cite>nltk.data.load()</cite> is unable to determine the format based on the
filename's extension, it will raise a ValueError:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.load(<span class="pysrc-string">'foo.bar'</span>)
<span class="pysrc-except">Traceback (most recent call last):</span>
<span class="pysrc-except">  . . .</span>
<span class="pysrc-except">ValueError: Could not determine format for foo.bar based on its file</span>
<span class="pysrc-except">extension; use the &quot;format&quot; argument to specify the format explicitly.</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Note that by explicitly specifying the <tt class="doctest"><span class="pre">format</span></tt> argument, you can
override the load method's default processing behavior.  For example,
to get the raw contents of any file, simply use <tt class="doctest"><span class="pre">format=<span class="pysrc-string">&quot;raw&quot;</span></span></tt>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>s = nltk.data.load(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>, <span class="pysrc-string">'text'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(s) 
<span class="pysrc-output">S -&gt; NP VP</span>
<span class="pysrc-output">PP -&gt; P NP</span>
<span class="pysrc-output">NP -&gt; Det N | NP PP</span>
<span class="pysrc-output">VP -&gt; V NP | VP PP</span>
<span class="pysrc-output">...</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="making-local-copies">
<h1>3&nbsp;&nbsp;&nbsp;Making Local Copies</h1>
<!-- This will not be visible in the html output: create a tempdir to
play in.
>>> import tempfile, os
>>> tempdir = tempfile.mkdtemp()
>>> old_dir = os.path.abspath('.')
>>> os.chdir(tempdir) -->
<p>The function <cite>nltk.data.retrieve()</cite> copies a given resource to a local
file.  This can be useful, for example, if you want to edit one of the
sample grammars.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.retrieve(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>)
<span class="pysrc-output">Retrieving 'nltk:grammars/sample_grammars/toy.cfg', saving to 'toy.cfg'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Simulate editing the grammar.</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>with open(<span class="pysrc-string">'toy.cfg'</span>) <span class="pysrc-keyword">as</span> inp:
<span class="pysrc-more">... </span>    s = inp.read().replace(<span class="pysrc-string">'NP'</span>, <span class="pysrc-string">'DP'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>with open(<span class="pysrc-string">'toy.cfg'</span>, <span class="pysrc-string">'w'</span>) <span class="pysrc-keyword">as</span> out:
<span class="pysrc-more">... </span>    _bytes_written = out.write(s)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Load the edited grammar, &amp; display it.</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>cfg = nltk.data.load(<span class="pysrc-string">'file:///'</span> + os.path.abspath(<span class="pysrc-string">'toy.cfg'</span>))
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(cfg) 
<span class="pysrc-output">Grammar with 14 productions (start state = S)</span>
<span class="pysrc-output">    S -&gt; DP VP</span>
<span class="pysrc-output">    PP -&gt; P DP</span>
<span class="pysrc-output">    ...</span>
<span class="pysrc-output">    P -&gt; 'on'</span>
<span class="pysrc-output">    P -&gt; 'in'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The second argument to <cite>nltk.data.retrieve()</cite> specifies the filename
for the new copy of the file.  By default, the source file's filename
is used.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.retrieve(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>, <span class="pysrc-string">'mytoy.cfg'</span>)
<span class="pysrc-output">Retrieving 'nltk:grammars/sample_grammars/toy.cfg', saving to 'mytoy.cfg'</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>os.path.isfile(<span class="pysrc-string">'./mytoy.cfg'</span>)
<span class="pysrc-output">True</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.retrieve(<span class="pysrc-string">'grammars/sample_grammars/np.fcfg'</span>)
<span class="pysrc-output">Retrieving 'nltk:grammars/sample_grammars/np.fcfg', saving to 'np.fcfg'</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>os.path.isfile(<span class="pysrc-string">'./np.fcfg'</span>)
<span class="pysrc-output">True</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>If a file with the specified (or default) filename already exists in
the current directory, then <cite>nltk.data.retrieve()</cite> will raise a
ValueError exception.  It will <em>not</em> overwrite the file:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>os.path.isfile(<span class="pysrc-string">'./toy.cfg'</span>)
<span class="pysrc-output">True</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.retrieve(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>) 
<span class="pysrc-except">Traceback (most recent call last):</span>
<span class="pysrc-except">  . . .</span>
<span class="pysrc-except">ValueError: File '...toy.cfg' already exists!</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<!-- This will not be visible in the html output: clean up the tempdir.
>>> os.chdir(old_dir)
>>> for f in os.listdir(tempdir):
...     os.remove(os.path.join(tempdir, f))
>>> os.rmdir(tempdir) -->
</div>
<div class="section" id="finding-files-in-the-nltk-data-package">
<h1>4&nbsp;&nbsp;&nbsp;Finding Files in the NLTK Data Package</h1>
<p>The <cite>nltk.data.find()</cite> function searches the NLTK data package for a
given file, and returns a pointer to that file.  This pointer can
either be a <cite>FileSystemPathPointer</cite> (whose <cite>path</cite> attribute gives the
absolute path of the file); or a <cite>ZipFilePathPointer</cite>, specifying a
zipfile and the name of an entry within that zipfile.  Both pointer
types define the <cite>open()</cite> method, which can be used to read the string
contents of the file.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>path = nltk.data.find(<span class="pysrc-string">'corpora/abc/rural.txt'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>str(path) 
<span class="pysrc-output">'...rural.txt'</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(path.open().read(60).decode())
<span class="pysrc-output">PM denies knowledge of AWB kickbacks</span>
<span class="pysrc-output">The Prime Minister has</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Alternatively, the <cite>nltk.data.load()</cite> function can be used with the
keyword argument <tt class="doctest"><span class="pre">format=<span class="pysrc-string">&quot;raw&quot;</span></span></tt>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>s = nltk.data.load(<span class="pysrc-string">'corpora/abc/rural.txt'</span>, format=<span class="pysrc-string">'raw'</span>)[:60]
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(s.decode())
<span class="pysrc-output">PM denies knowledge of AWB kickbacks</span>
<span class="pysrc-output">The Prime Minister has</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Alternatively, you can use the keyword argument <tt class="doctest"><span class="pre">format=<span class="pysrc-string">&quot;text&quot;</span></span></tt>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>s = nltk.data.load(<span class="pysrc-string">'corpora/abc/rural.txt'</span>, format=<span class="pysrc-string">'text'</span>)[:60]
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(s)
<span class="pysrc-output">PM denies knowledge of AWB kickbacks</span>
<span class="pysrc-output">The Prime Minister has</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="resource-caching">
<h1>5&nbsp;&nbsp;&nbsp;Resource Caching</h1>
<p>NLTK uses a weakref dictionary to maintain a cache of resources that
have been loaded.  If you load a resource that is already stored in
the cache, then the cached copy will be returned.  This behavior can
be seen by the trace output generated when verbose=True:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>feat0 = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>, verbose=True)
<span class="pysrc-output">&lt;&lt;Loading nltk:grammars/book_grammars/feat0.fcfg&gt;&gt;</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>feat0 = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>, verbose=True)
<span class="pysrc-output">&lt;&lt;Using cached copy of nltk:grammars/book_grammars/feat0.fcfg&gt;&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>If you wish to load a resource from its source, bypassing the cache,
use the <tt class="doctest"><span class="pre">cache=False</span></tt> argument to <cite>nltk.data.load()</cite>.  This can be
useful, for example, if the resource is loaded from a local file, and
you are actively editing that file:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>feat0 = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>,cache=False,verbose=True)
<span class="pysrc-output">&lt;&lt;Loading nltk:grammars/book_grammars/feat0.fcfg&gt;&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The cache <em>no longer</em> uses weak references.  A resource will not be
automatically expunged from the cache when no more objects are using
it.  In the following example, when we clear the variable <tt class="doctest"><span class="pre">feat0</span></tt>,
the reference count for the feature grammar object drops to zero.
However, the object remains cached:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">del</span> feat0
<span class="pysrc-prompt">&gt;&gt;&gt; </span>feat0 = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/feat0.fcfg'</span>,
<span class="pysrc-more">... </span>                       verbose=True)
<span class="pysrc-output">&lt;&lt;Using cached copy of nltk:grammars/book_grammars/feat0.fcfg&gt;&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>You can clear the entire contents of the cache, using
<cite>nltk.data.clear_cache()</cite>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.clear_cache()</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="retrieving-other-data-sources">
<h1>6&nbsp;&nbsp;&nbsp;Retrieving other Data Sources</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>formulas = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/background.fol'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> f <span class="pysrc-keyword">in</span> formulas: <span class="pysrc-keyword">print</span>(str(f))
<span class="pysrc-output">all x.(boxerdog(x) -&gt; dog(x))</span>
<span class="pysrc-output">all x.(boxer(x) -&gt; person(x))</span>
<span class="pysrc-output">all x.-(dog(x) &amp; person(x))</span>
<span class="pysrc-output">all x.(married(x) &lt;-&gt; exists y.marry(x,y))</span>
<span class="pysrc-output">all x.(bark(x) -&gt; dog(x))</span>
<span class="pysrc-output">all x y.(marry(x,y) -&gt; (person(x) &amp; person(y)))</span>
<span class="pysrc-output">-(Vincent = Mia)</span>
<span class="pysrc-output">-(Vincent = Fido)</span>
<span class="pysrc-output">-(Mia = Fido)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="regression-tests">
<h1>7&nbsp;&nbsp;&nbsp;Regression Tests</h1>
<p>Create a temp dir for tests that write files:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> tempfile, os
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tempdir = tempfile.mkdtemp()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>old_dir = os.path.abspath(<span class="pysrc-string">'.'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>os.chdir(tempdir)</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The <cite>retrieve()</cite> function accepts all url types:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>urls = [<span class="pysrc-string">'http://nltk.googlecode.com/svn/trunk/nltk/nltk/test/toy.cfg'</span>,
<span class="pysrc-more">... </span>        <span class="pysrc-string">'file:%s'</span> % nltk.data.find(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>),
<span class="pysrc-more">... </span>        <span class="pysrc-string">'nltk:grammars/sample_grammars/toy.cfg'</span>,
<span class="pysrc-more">... </span>        <span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>]
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> i, url <span class="pysrc-keyword">in</span> enumerate(urls):
<span class="pysrc-more">... </span>    nltk.data.retrieve(url, <span class="pysrc-string">'toy-%d.cfg'</span> % i) 
<span class="pysrc-output">Retrieving 'http://nltk.googlecode.com/svn/trunk/nltk/nltk/test/toy.cfg', saving to 'toy-0.cfg'</span>
<span class="pysrc-output">Retrieving 'file:...toy.cfg', saving to 'toy-1.cfg'</span>
<span class="pysrc-output">Retrieving 'nltk:grammars/sample_grammars/toy.cfg', saving to 'toy-2.cfg'</span>
<span class="pysrc-output">Retrieving 'nltk:grammars/sample_grammars/toy.cfg', saving to 'toy-3.cfg'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Clean up the temp dir:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>os.chdir(old_dir)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> f <span class="pysrc-keyword">in</span> os.listdir(tempdir):
<span class="pysrc-more">... </span>    os.remove(os.path.join(tempdir, f))
<span class="pysrc-prompt">&gt;&gt;&gt; </span>os.rmdir(tempdir)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="section" id="lazy-loader">
<h2>7.1&nbsp;&nbsp;&nbsp;Lazy Loader</h2>
<p>A lazy loader is a wrapper object that defers loading a resource until
it is accessed or used in any way.  This is mainly intended for
internal use by NLTK's corpus readers.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Create a lazy loader for toy.cfg.</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>ll = nltk.data.LazyLoader(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>)</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Show that it's not loaded yet:</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>object.__repr__(ll) 
<span class="pysrc-output">'&lt;nltk.data.LazyLoader object at ...&gt;'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># printing it is enough to cause it to be loaded:</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(ll)
<span class="pysrc-output">&lt;Grammar with 14 productions&gt;</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Show that it's now been loaded:</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>object.__repr__(ll) 
<span class="pysrc-output">'&lt;nltk.grammar.CFG object at ...&gt;'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-comment"># Test that accessing an attribute also loads it:</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>ll = nltk.data.LazyLoader(<span class="pysrc-string">'grammars/sample_grammars/toy.cfg'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>ll.start()
<span class="pysrc-output">S</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>object.__repr__(ll) 
<span class="pysrc-output">'&lt;nltk.grammar.CFG object at ...&gt;'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="buffered-gzip-reading-and-writing">
<h2>7.2&nbsp;&nbsp;&nbsp;Buffered Gzip Reading and Writing</h2>
<p>Write performance to gzip-compressed is extremely poor when the files become large.
File creation can become a bottleneck in those cases.</p>
<p>Read performance from large gzipped pickle files was improved in data.py by
buffering the reads. A similar fix can be applied to writes by buffering
the writes to a StringIO object first.</p>
<p>This is mainly intended for internal use. The test simply tests that reading
and writing work as intended and does not test how much improvement buffering
provides.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.compat <span class="pysrc-keyword">import</span> StringIO
<span class="pysrc-prompt">&gt;&gt;&gt; </span>test = nltk.data.BufferedGzipFile(<span class="pysrc-string">'testbuf.gz'</span>, <span class="pysrc-string">'wb'</span>, size=2**10)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>ans = []
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> i <span class="pysrc-keyword">in</span> range(10000):
<span class="pysrc-more">... </span>    ans.append(str(i).encode(<span class="pysrc-string">'ascii'</span>))
<span class="pysrc-more">... </span>    test.write(str(i).encode(<span class="pysrc-string">'ascii'</span>))
<span class="pysrc-prompt">&gt;&gt;&gt; </span>test.close()
<span class="pysrc-prompt">&gt;&gt;&gt; </span>test = nltk.data.BufferedGzipFile(<span class="pysrc-string">'testbuf.gz'</span>, <span class="pysrc-string">'rb'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>test.read() == b<span class="pysrc-string">''</span>.join(ans)
<span class="pysrc-output">True</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>test.close()
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> os
<span class="pysrc-prompt">&gt;&gt;&gt; </span>os.unlink(<span class="pysrc-string">'testbuf.gz'</span>)</pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="json-encoding-and-decoding">
<h2>7.3&nbsp;&nbsp;&nbsp;JSON Encoding and Decoding</h2>
<p>JSON serialization is used instead of pickle for some classes.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk <span class="pysrc-keyword">import</span> jsontags
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.jsontags <span class="pysrc-keyword">import</span> JSONTaggedEncoder, JSONTaggedDecoder, register_tag
<span class="pysrc-prompt">&gt;&gt;&gt; </span>&#64;jsontags.register_tag
<span class="pysrc-more">... </span><span class="pysrc-keyword">class</span> <span class="pysrc-defname">JSONSerializable</span>:
<span class="pysrc-more">... </span>    json_tag = <span class="pysrc-string">'JSONSerializable'</span>
<span class="pysrc-more">...</span>
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">def</span> <span class="pysrc-defname">__init__</span>(self, n):
<span class="pysrc-more">... </span>        self.n = n
<span class="pysrc-more">...</span>
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">def</span> <span class="pysrc-defname">encode_json_obj</span>(self):
<span class="pysrc-more">... </span>        return self.n
<span class="pysrc-more">...</span>
<span class="pysrc-more">... </span>    &#64;classmethod
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">def</span> <span class="pysrc-defname">decode_json_obj</span>(cls, obj):
<span class="pysrc-more">... </span>        n = obj
<span class="pysrc-more">... </span>        return cls(n)
<span class="pysrc-more">...</span>
<span class="pysrc-prompt">&gt;&gt;&gt; </span>JSONTaggedEncoder().encode(JSONSerializable(1))
<span class="pysrc-output">'{&quot;!JSONSerializable&quot;: 1}'</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>JSONTaggedDecoder().decode(<span class="pysrc-string">'{&quot;!JSONSerializable&quot;: 1}'</span>).n
<span class="pysrc-output">1</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
</div>
</div>
</body>
</html>
