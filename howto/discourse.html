<?xml version="1.0" encoding="ascii" ?>

<script language="javascript" type="text/javascript">

function astext(node)
{
    return node.innerHTML.replace(/(<([^>]+)>)/ig,"")
                         .replace(/&gt;/ig, ">")
                         .replace(/&lt;/ig, "<")
                         .replace(/&quot;/ig, '"')
                         .replace(/&amp;/ig, "&");
}

function copy_notify(node, bar_color, data)
{
    // The outer box: relative + inline positioning.
    var box1 = document.createElement("div");
    box1.style.position = "relative";
    box1.style.display = "inline";
    box1.style.top = "2em";
    box1.style.left = "1em";
  
    // A shadow for fun
    var shadow = document.createElement("div");
    shadow.style.position = "absolute";
    shadow.style.left = "-1.3em";
    shadow.style.top = "-1.3em";
    shadow.style.background = "#404040";
    
    // The inner box: absolute positioning.
    var box2 = document.createElement("div");
    box2.style.position = "relative";
    box2.style.border = "1px solid #a0a0a0";
    box2.style.left = "-.2em";
    box2.style.top = "-.2em";
    box2.style.background = "white";
    box2.style.padding = ".3em .4em .3em .4em";
    box2.style.fontStyle = "normal";
    box2.style.background = "#f0e0e0";

    node.insertBefore(box1, node.childNodes.item(0));
    box1.appendChild(shadow);
    shadow.appendChild(box2);
    box2.innerHTML="Copied&nbsp;to&nbsp;the&nbsp;clipboard: " +
                   "<pre class='copy-notify'>"+
                   data+"</pre>";
    setTimeout(function() { node.removeChild(box1); }, 1000);

    var elt = node.parentNode.firstChild;
    elt.style.background = "#ffc0c0";
    setTimeout(function() { elt.style.background = bar_color; }, 200);
}

function copy_codeblock_to_clipboard(node)
{
    var data = astext(node)+"\n";
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#40a060", data);
    }
}

function copy_doctest_to_clipboard(node)
{
    var s = astext(node)+"\n   ";
    var data = "";

    var start = 0;
    var end = s.indexOf("\n");
    while (end >= 0) {
        if (s.substring(start, start+4) == ">>> ") {
            data += s.substring(start+4, end+1);
        }
        else if (s.substring(start, start+4) == "... ") {
            data += s.substring(start+4, end+1);
        }
        /*
        else if (end-start > 1) {
            data += "# " + s.substring(start, end+1);
        }*/
        // Grab the next line.
        start = end+1;
        end = s.indexOf("\n", start);
    }
    
    if (copy_text_to_clipboard(data)) {
        copy_notify(node, "#4060a0", data);
    }
}
    
function copy_text_to_clipboard(data)
{
    if (window.clipboardData) {
        window.clipboardData.setData("Text", data);
        return true;
     }
    else if (window.netscape) {
        // w/ default firefox settings, permission will be denied for this:
        netscape.security.PrivilegeManager
                      .enablePrivilege("UniversalXPConnect");
    
        var clip = Components.classes["@mozilla.org/widget/clipboard;1"]
                      .createInstance(Components.interfaces.nsIClipboard);
        if (!clip) return;
    
        var trans = Components.classes["@mozilla.org/widget/transferable;1"]
                       .createInstance(Components.interfaces.nsITransferable);
        if (!trans) return;
    
        trans.addDataFlavor("text/unicode");
    
        var str = new Object();
        var len = new Object();
    
        var str = Components.classes["@mozilla.org/supports-string;1"]
                     .createInstance(Components.interfaces.nsISupportsString);
        var datacopy=data;
        str.data=datacopy;
        trans.setTransferData("text/unicode",str,datacopy.length*2);
        var clipid=Components.interfaces.nsIClipboard;
    
        if (!clip) return false;
    
        clip.setData(trans,null,clipid.kGlobalClipboard);
        return true;
    }
    return false;
}
//-->
</script>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ascii" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Discourse Checking</title>
<style type="text/css">

/*
:Author: Edward Loper, James Curran
:Copyright: This stylesheet has been placed in the public domain.

Stylesheet for use with Docutils.

This stylesheet defines new css classes used by NLTK.

It uses a Python syntax highlighting scheme that matches
the colour scheme used by IDLE, which makes it easier for
beginners to check they are typing things in correctly.
*/

/* Include the standard docutils stylesheet. */
@import url(default.css);

/* Custom inline roles */
span.placeholder    { font-style: italic; font-family: monospace; }
span.example        { font-style: italic; }
span.emphasis       { font-style: italic; }
span.termdef        { font-weight: bold; }
/*span.term           { font-style: italic; }*/
span.category       { font-variant: small-caps; }
span.feature        { font-variant: small-caps; }
span.fval           { font-style: italic; }
span.math           { font-style: italic; }
span.mathit         { font-style: italic; }
span.lex            { font-variant: small-caps; }
span.guide-linecount{ text-align: right; display: block;}

/* Python souce code listings */
span.pysrc-prompt   { color: #9b0000; }
span.pysrc-more     { color: #9b00ff; }
span.pysrc-keyword  { color: #e06000; }
span.pysrc-builtin  { color: #940094; }
span.pysrc-string   { color: #00aa00; }
span.pysrc-comment  { color: #ff0000; }
span.pysrc-output   { color: #0000ff; }
span.pysrc-except   { color: #ff0000; }
span.pysrc-defname  { color: #008080; }


/* Doctest blocks */
pre.doctest         { margin: 0; padding: 0; font-weight: bold; }
div.doctest         { margin: 0 1em 1em 1em; padding: 0; }
table.doctest       { margin: 0; padding: 0;
                      border-top: 1px solid gray;
                      border-bottom: 1px solid gray; }
pre.copy-notify     { margin: 0; padding: 0.2em; font-weight: bold;
                      background-color: #ffffff; }

/* Python source listings */
div.pylisting       { margin: 0 1em 1em 1em; padding: 0; }
table.pylisting     { margin: 0; padding: 0;
                      border-top: 1px solid gray; }
td.caption { border-top: 1px solid black; margin: 0; padding: 0; }
.caption-label { font-weight: bold;  }
td.caption p { margin: 0; padding: 0; font-style: normal;}

table tr td.codeblock { 
  padding: 0.2em ! important; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeffee;
}

table tr td.doctest  { 
  padding: 0.2em; margin: 0;
  border-left: 1px solid gray;
  border-right: 2px solid gray;
  border-top: 0px solid gray;
  border-bottom: 1px solid gray;
  font-weight: bold; background-color: #eeeeff;
}

td.codeblock table tr td.copybar {
    background: #40a060; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }
td.doctest table tr td.copybar {
    background: #4060a0; border: 1px solid gray;
    font-family: monospace; padding: 0; margin: 0; }

td.pysrc { padding-left: 0.5em; }

img.callout { border-width: 0px; }

table.docutils {
    border-style: solid;
    border-width: 1px;
    margin-top: 6px;
    border-color: grey;
    border-collapse: collapse; }

table.docutils th {
    border-style: none;
    border-width: 1px;
    border-color: grey;
    padding: 0 .5em 0 .5em; }

table.docutils td {
    border-style: none;
    border-width: 1px;
    border-color: grey; 
    padding: 0 .5em 0 .5em; }

table.footnote td { padding: 0; }
table.footnote { border-width: 0; }
table.footnote td { border-width: 0; }
table.footnote th { border-width: 0; }

table.noborder { border-width: 0; }

table.example pre { margin-top: 4px; margin-bottom: 0; }

/* For figures & tables */
p.caption { margin-bottom: 0; }
div.figure { text-align: center; }

/* The index */
div.index { border: 1px solid black;
            background-color: #eeeeee; }
div.index h1 { padding-left: 0.5em; margin-top: 0.5ex;
               border-bottom: 1px solid black; }
ul.index { margin-left: 0.5em; padding-left: 0; }
li.index { list-style-type: none; }
p.index-heading { font-size: 120%; font-style: italic; margin: 0; }
li.index ul { margin-left: 2em; padding-left: 0; }

/* 'Note' callouts */
div.note
{
  border-right:   #87ceeb 1px solid;
  padding-right: 4px;
  border-top: #87ceeb 1px solid;
  padding-left: 4px;
  padding-bottom: 4px;
  margin: 2px 5% 10px;
  border-left: #87ceeb 1px solid;
  padding-top: 4px;
  border-bottom: #87ceeb 1px solid;
  font-style: normal;
  font-family: verdana, arial;
  background-color: #b0c4de;
}

table.avm { border: 0px solid black; width: 0; }
table.avm tbody tr {border: 0px solid black; }
table.avm tbody tr td { padding: 2px; }
table.avm tbody tr td.avm-key { padding: 5px; font-variant: small-caps; }
table.avm tbody tr td.avm-eq { padding: 5px; }
table.avm tbody tr td.avm-val { padding: 5px; font-style: italic; }
p.avm-empty { font-style: normal; }
table.avm colgroup col { border: 0px solid black; }
table.avm tbody tr td.avm-topleft 
    { border-left: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botleft 
    { border-left: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-topright
    { border-right: 2px solid #000080; border-top: 2px solid #000080; }
table.avm tbody tr td.avm-botright
    { border-right: 2px solid #000080; border-bottom: 2px solid #000080; }
table.avm tbody tr td.avm-left
    { border-left: 2px solid #000080; }
table.avm tbody tr td.avm-right
    { border-right: 2px solid #000080; }
table.avm tbody tr td.avm-topbotleft
    { border: 2px solid #000080; border-right: 0px solid black; }
table.avm tbody tr td.avm-topbotright
    { border: 2px solid #000080; border-left: 0px solid black; }
table.avm tbody tr td.avm-ident
    { font-size: 80%; padding: 0; padding-left: 2px; vertical-align: top; }
.avm-pointer
{ border: 1px solid #008000; padding: 1px; color: #008000; 
  background: #c0ffc0; font-style: normal; }

table.gloss { border: 0px solid black; width: 0; }
table.gloss tbody tr { border: 0px solid black; }
table.gloss tbody tr td { border: 0px solid black; }
table.gloss colgroup col { border: 0px solid black; }
table.gloss p { margin: 0; padding: 0; }

table.rst-example { border: 1px solid black; }
table.rst-example tbody tr td { background: #eeeeee; }
table.rst-example thead tr th { background: #c0ffff; }
td.rst-raw { width: 0; }

/* Used by nltk.org/doc/test: */
div.doctest-list { text-align: center; }
table.doctest-list { border: 1px solid black;
  margin-left: auto; margin-right: auto;
}
table.doctest-list tbody tr td { background: #eeeeee;
  border: 1px solid #cccccc; text-align: left; }
table.doctest-list thead tr th { background: #304050; color: #ffffff;
  border: 1px solid #000000;}
table.doctest-list thead tr a { color: #ffffff; }
span.doctest-passed { color: #008000; }
span.doctest-failed { color: #800000; }

</style>
</head>
<body>
<div class="document" id="discourse-checking">
<h1 class="title">Discourse Checking</h1>

<!-- Copyright (C) 2001-2014 NLTK Project -->
<!-- For license information, see LICENSE.TXT -->
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk <span class="pysrc-keyword">import</span> *
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.sem <span class="pysrc-keyword">import</span> logic
<span class="pysrc-prompt">&gt;&gt;&gt; </span>logic._counter._value = 0</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="section" id="introduction">
<h1>1&nbsp;&nbsp;&nbsp;Introduction</h1>
<p>The NLTK discourse module makes it possible to test consistency and
redundancy of simple discourses, using theorem-proving and
model-building from <cite>nltk.inference</cite>.</p>
<p>The <tt class="doctest"><span class="pre">DiscourseTester</span></tt> constructor takes a list of sentences as a
parameter.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt = DiscourseTester([<span class="pysrc-string">'a boxer walks'</span>, <span class="pysrc-string">'every boxer chases a girl'</span>])</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The <tt class="doctest"><span class="pre">DiscourseTester</span></tt> parses each sentence into a list of logical
forms.  Once we have created <tt class="doctest"><span class="pre">DiscourseTester</span></tt> object, we can
inspect various properties of the discourse. First off, we might want
to double-check what sentences are currently stored as the discourse.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.sentences()
<span class="pysrc-output">s0: a boxer walks</span>
<span class="pysrc-output">s1: every boxer chases a girl</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>As you will see, each sentence receives an identifier <cite>s</cite><sub>i</sub>.
We might also want to check what grammar the <tt class="doctest"><span class="pre">DiscourseTester</span></tt> is
using (by default, <tt class="doctest"><span class="pre">book_grammars/discourse.fcfg</span></tt>):</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.grammar() 
<span class="pysrc-output">% start S</span>
<span class="pysrc-output"># Grammar Rules</span>
<span class="pysrc-output">S[SEM = &lt;app(?subj,?vp)&gt;] -&gt; NP[NUM=?n,SEM=?subj] VP[NUM=?n,SEM=?vp]</span>
<span class="pysrc-output">NP[NUM=?n,SEM=&lt;app(?det,?nom)&gt; ] -&gt; Det[NUM=?n,SEM=?det]  Nom[NUM=?n,SEM=?nom]</span>
<span class="pysrc-output">NP[LOC=?l,NUM=?n,SEM=?np] -&gt; PropN[LOC=?l,NUM=?n,SEM=?np]</span>
<span class="pysrc-output">...</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>A different grammar can be invoked by using the optional <tt class="doctest"><span class="pre">gramfile</span></tt>
parameter when a <tt class="doctest"><span class="pre">DiscourseTester</span></tt> object is created.</p>
</div>
<div class="section" id="readings-and-threads">
<h1>2&nbsp;&nbsp;&nbsp;Readings and Threads</h1>
<p>Depending on
the grammar used, we may find some sentences have more than one
logical form. To check this, use the <tt class="doctest"><span class="pre">readings()</span></tt> method. Given a
sentence identifier of the form <cite>s</cite><sub>i</sub>, each reading of
that sentence is given an identifier <cite>s</cite><sub>i</sub>-<cite>r</cite><sub>j</sub>.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings()
<span class="pysrc-output"></span>
<span class="pysrc-output">s0 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s0-r0: exists z1.(boxer(z1) &amp; walk(z1))</span>
<span class="pysrc-output">s0-r1: exists z1.(boxerdog(z1) &amp; walk(z1))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1-r0: all z2.(boxer(z2) -&gt; exists z3.(girl(z3) &amp; chase(z2,z3)))</span>
<span class="pysrc-output">s1-r1: all z1.(boxerdog(z1) -&gt; exists z2.(girl(z2) &amp; chase(z1,z2)))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>In this case, the only source of ambiguity lies in the word <em>boxer</em>,
which receives two translations: <tt class="doctest"><span class="pre">boxer</span></tt> and <tt class="doctest"><span class="pre">boxerdog</span></tt>. The
intention is that one of these corresponds to the <tt class="doctest"><span class="pre">person</span></tt> sense and
one to the <tt class="doctest"><span class="pre">dog</span></tt> sense. In principle, we would also expect to see a
quantifier scope ambiguity in <tt class="doctest"><span class="pre">s1</span></tt>. However, the simple grammar we
are using, namely <a class="reference external" href="sem4.fcfg">sem4.fcfg</a>, doesn't support quantifier
scope ambiguity.</p>
<p>We can also investigate the readings of a specific sentence:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(<span class="pysrc-string">'a boxer walks'</span>)
<span class="pysrc-output">The sentence 'a boxer walks' has these readings:</span>
<span class="pysrc-output">    exists x.(boxer(x) &amp; walk(x))</span>
<span class="pysrc-output">    exists x.(boxerdog(x) &amp; walk(x))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Given that each sentence is two-ways ambiguous, we potentially have
four different discourse 'threads', taking all combinations of
readings. To see these, specify the <tt class="doctest"><span class="pre">threaded=True</span></tt> parameter on
the <tt class="doctest"><span class="pre">readings()</span></tt> method. Again, each thread is assigned an
identifier of the form <cite>d</cite><sub>i</sub>. Following the identifier is a
list of the readings that constitute that thread.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(threaded=True) 
<span class="pysrc-output">d0: ['s0-r0', 's1-r0']</span>
<span class="pysrc-output">d1: ['s0-r0', 's1-r1']</span>
<span class="pysrc-output">d2: ['s0-r1', 's1-r0']</span>
<span class="pysrc-output">d3: ['s0-r1', 's1-r1']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Of course, this simple-minded approach doesn't scale: a discourse with, say, three
sentences, each of which has 3 readings, will generate 27 different
threads. It is an interesting exercise to consider how to manage
discourse ambiguity more efficiently.</p>
</div>
<div class="section" id="checking-consistency">
<h1>3&nbsp;&nbsp;&nbsp;Checking Consistency</h1>
<p>Now, we can check whether some or all of the discourse threads are
consistent, using the <tt class="doctest"><span class="pre">models()</span></tt> method. With no parameter, this
method will try to find a model for every discourse thread in the
current discourse. However, we can also specify just one thread, say <tt class="doctest"><span class="pre">d1</span></tt>.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.models(<span class="pysrc-string">'d1'</span>)
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d1</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">% number = 1</span>
<span class="pysrc-output">% seconds = 0</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">% Interpretation of size 2</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">c1 = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">f1(0) = 0.</span>
<span class="pysrc-output">f1(1) = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  boxer(0).</span>
<span class="pysrc-output">- boxer(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- boxerdog(0).</span>
<span class="pysrc-output">- boxerdog(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- girl(0).</span>
<span class="pysrc-output">- girl(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  walk(0).</span>
<span class="pysrc-output">- walk(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- chase(0,0).</span>
<span class="pysrc-output">- chase(0,1).</span>
<span class="pysrc-output">- chase(1,0).</span>
<span class="pysrc-output">- chase(1,1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Consistent discourse: d1 ['s0-r0', 's1-r1']:</span>
<span class="pysrc-output">    s0-r0: exists z1.(boxer(z1) &amp; walk(z1))</span>
<span class="pysrc-output">    s1-r1: all z1.(boxerdog(z1) -&gt; exists z2.(girl(z2) &amp; chase(z1,z2)))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>There are various formats for rendering <strong>Mace4</strong> models --- here,
we have used the 'cooked' format (which is intended to be
human-readable). There are a number of points to note.</p>
<ol class="arabic simple">
<li>The entities in the domain are all treated as non-negative
integers. In this case, there are only two entities, <tt class="doctest"><span class="pre">0</span></tt> and
<tt class="doctest"><span class="pre">1</span></tt>.</li>
<li>The <tt class="doctest"><span class="pre">-</span></tt> symbol indicates negation. So <tt class="doctest"><span class="pre">0</span></tt> is the only
<tt class="doctest"><span class="pre">boxerdog</span></tt> and the only thing that <tt class="doctest"><span class="pre">walk</span></tt>s. Nothing is a
<tt class="doctest"><span class="pre">boxer</span></tt>, or a <tt class="doctest"><span class="pre">girl</span></tt> or in the <tt class="doctest"><span class="pre">chase</span></tt> relation. Thus the
universal sentence is vacuously true.</li>
<li><tt class="doctest"><span class="pre">c1</span></tt> is an introduced constant that denotes <tt class="doctest"><span class="pre">0</span></tt>.</li>
<li><tt class="doctest"><span class="pre">f1</span></tt> is a Skolem function, but it plays no significant role in
this model.</li>
</ol>
<p>We might want to now add another sentence to the discourse, and there
is method <tt class="doctest"><span class="pre">add_sentence()</span></tt> for doing just this.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.add_sentence(<span class="pysrc-string">'John is a boxer'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.sentences()
<span class="pysrc-output">s0: a boxer walks</span>
<span class="pysrc-output">s1: every boxer chases a girl</span>
<span class="pysrc-output">s2: John is a boxer</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>We can now test all the properties as before; here, we just show a
couple of them.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings()
<span class="pysrc-output"></span>
<span class="pysrc-output">s0 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s0-r0: exists z1.(boxer(z1) &amp; walk(z1))</span>
<span class="pysrc-output">s0-r1: exists z1.(boxerdog(z1) &amp; walk(z1))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1-r0: all z1.(boxer(z1) -&gt; exists z2.(girl(z2) &amp; chase(z1,z2)))</span>
<span class="pysrc-output">s1-r1: all z1.(boxerdog(z1) -&gt; exists z2.(girl(z2) &amp; chase(z1,z2)))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2-r0: boxer(John)</span>
<span class="pysrc-output">s2-r1: boxerdog(John)</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(threaded=True) 
<span class="pysrc-output">d0: ['s0-r0', 's1-r0', 's2-r0']</span>
<span class="pysrc-output">d1: ['s0-r0', 's1-r0', 's2-r1']</span>
<span class="pysrc-output">d2: ['s0-r0', 's1-r1', 's2-r0']</span>
<span class="pysrc-output">d3: ['s0-r0', 's1-r1', 's2-r1']</span>
<span class="pysrc-output">d4: ['s0-r1', 's1-r0', 's2-r0']</span>
<span class="pysrc-output">d5: ['s0-r1', 's1-r0', 's2-r1']</span>
<span class="pysrc-output">d6: ['s0-r1', 's1-r1', 's2-r0']</span>
<span class="pysrc-output">d7: ['s0-r1', 's1-r1', 's2-r1']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>If you are interested in a particular thread, the <tt class="doctest"><span class="pre">expand_threads()</span></tt>
method will remind you of what readings it consists of:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>thread = dt.expand_threads(<span class="pysrc-string">'d1'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">for</span> rid, reading <span class="pysrc-keyword">in</span> thread:
<span class="pysrc-more">... </span>    <span class="pysrc-keyword">print</span>(rid, str(reading.normalize()))
<span class="pysrc-output">s0-r0 exists z1.(boxer(z1) &amp; walk(z1))</span>
<span class="pysrc-output">s1-r0 all z1.(boxer(z1) -&gt; exists z2.(girl(z2) &amp; chase(z1,z2)))</span>
<span class="pysrc-output">s2-r1 boxerdog(John)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Suppose we have already defined a discourse, as follows:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt = DiscourseTester([<span class="pysrc-string">'A student dances'</span>, <span class="pysrc-string">'Every student is a person'</span>])</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>Now, when we add a new sentence, is it consistent with what we already
have? The `` consistchk=True`` parameter of <tt class="doctest"><span class="pre">add_sentence()</span></tt> allows
us to check:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.add_sentence(<span class="pysrc-string">'No person dances'</span>, consistchk=True)
<span class="pysrc-output">Inconsistent discourse: d0 ['s0-r0', 's1-r0', 's2-r0']:</span>
<span class="pysrc-output">    s0-r0: exists z1.(student(z1) &amp; dance(z1))</span>
<span class="pysrc-output">    s1-r0: all z1.(student(z1) -&gt; person(z1))</span>
<span class="pysrc-output">    s2-r0: -exists z1.(person(z1) &amp; dance(z1))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings()
<span class="pysrc-output"></span>
<span class="pysrc-output">s0 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s0-r0: exists z1.(student(z1) &amp; dance(z1))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1-r0: all z1.(student(z1) -&gt; person(z1))</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2-r0: -exists z1.(person(z1) &amp; dance(z1))</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>So let's retract the inconsistent sentence:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.retract_sentence(<span class="pysrc-string">'No person dances'</span>, verbose=True) 
<span class="pysrc-output">Current sentences are</span>
<span class="pysrc-output">s0: A student dances</span>
<span class="pysrc-output">s1: Every student is a person</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>We can now verify that result is consistent.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.models()
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d0</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">% number = 1</span>
<span class="pysrc-output">% seconds = 0</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">% Interpretation of size 2</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">c1 = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  dance(0).</span>
<span class="pysrc-output">- dance(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  person(0).</span>
<span class="pysrc-output">- person(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  student(0).</span>
<span class="pysrc-output">- student(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Consistent discourse: d0 ['s0-r0', 's1-r0']:</span>
<span class="pysrc-output">    s0-r0: exists z1.(student(z1) &amp; dance(z1))</span>
<span class="pysrc-output">    s1-r0: all z1.(student(z1) -&gt; person(z1))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="checking-informativity">
<h1>4&nbsp;&nbsp;&nbsp;Checking Informativity</h1>
<p>Let's assume that we are still trying to extend the discourse <em>A
student dances.</em> <em>Every student is a person.</em> We add a new sentence,
but this time, we check whether it is informative with respect to what
has gone before.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.add_sentence(<span class="pysrc-string">'A person dances'</span>, informchk=True)
<span class="pysrc-output">Sentence 'A person dances' under reading 'exists x.(person(x) &amp; dance(x))':</span>
<span class="pysrc-output">Not informative relative to thread 'd0'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>In fact, we are just checking whether the new sentence is entailed by
the preceding discourse.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.models()
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d0</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">% number = 1</span>
<span class="pysrc-output">% seconds = 0</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">% Interpretation of size 2</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">c1 = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">c2 = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  dance(0).</span>
<span class="pysrc-output">- dance(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  person(0).</span>
<span class="pysrc-output">- person(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  student(0).</span>
<span class="pysrc-output">- student(1).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Consistent discourse: d0 ['s0-r0', 's1-r0', 's2-r0']:</span>
<span class="pysrc-output">    s0-r0: exists z1.(student(z1) &amp; dance(z1))</span>
<span class="pysrc-output">    s1-r0: all z1.(student(z1) -&gt; person(z1))</span>
<span class="pysrc-output">    s2-r0: exists z1.(person(z1) &amp; dance(z1))</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
<div class="section" id="adding-background-knowledge">
<h1>5&nbsp;&nbsp;&nbsp;Adding Background Knowledge</h1>
<p>Let's build a new discourse, and look at the readings of the component sentences:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt = DiscourseTester([<span class="pysrc-string">'Vincent is a boxer'</span>, <span class="pysrc-string">'Fido is a boxer'</span>, <span class="pysrc-string">'Vincent is married'</span>, <span class="pysrc-string">'Fido barks'</span>])
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings()
<span class="pysrc-output"></span>
<span class="pysrc-output">s0 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s0-r0: boxer(Vincent)</span>
<span class="pysrc-output">s0-r1: boxerdog(Vincent)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1-r0: boxer(Fido)</span>
<span class="pysrc-output">s1-r1: boxerdog(Fido)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s2-r0: married(Vincent)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s3 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s3-r0: bark(Fido)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>This gives us a lot of threads:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(threaded=True) 
<span class="pysrc-output">d0: ['s0-r0', 's1-r0', 's2-r0', 's3-r0']</span>
<span class="pysrc-output">d1: ['s0-r0', 's1-r1', 's2-r0', 's3-r0']</span>
<span class="pysrc-output">d2: ['s0-r1', 's1-r0', 's2-r0', 's3-r0']</span>
<span class="pysrc-output">d3: ['s0-r1', 's1-r1', 's2-r0', 's3-r0']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>We can eliminate some of the readings, and hence some of the threads,
by adding background information.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">import</span> nltk.data
<span class="pysrc-prompt">&gt;&gt;&gt; </span>bg = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/background.fol'</span>)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.add_background(bg)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.background()
<span class="pysrc-output">all x.(boxerdog(x) -&gt; dog(x))</span>
<span class="pysrc-output">all x.(boxer(x) -&gt; person(x))</span>
<span class="pysrc-output">all x.-(dog(x) &amp; person(x))</span>
<span class="pysrc-output">all x.(married(x) &lt;-&gt; exists y.marry(x,y))</span>
<span class="pysrc-output">all x.(bark(x) -&gt; dog(x))</span>
<span class="pysrc-output">all x y.(marry(x,y) -&gt; (person(x) &amp; person(y)))</span>
<span class="pysrc-output">-(Vincent = Mia)</span>
<span class="pysrc-output">-(Vincent = Fido)</span>
<span class="pysrc-output">-(Mia = Fido)</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The background information allows us to reject three of the threads as
inconsistent. To see what remains, use the <tt class="doctest"><span class="pre">filter=True</span></tt> parameter
on <tt class="doctest"><span class="pre">readings()</span></tt>.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(filter=True) 
<span class="pysrc-output">d1: ['s0-r0', 's1-r1', 's2-r0', 's3-r0']</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The <tt class="doctest"><span class="pre">models()</span></tt> method gives us more information about the surviving thread.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.models()
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d0</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">No model found!</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d1</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">% number = 1</span>
<span class="pysrc-output">% seconds = 0</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">% Interpretation of size 3</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Fido = 0.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Mia = 1.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Vincent = 2.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">f1(0) = 0.</span>
<span class="pysrc-output">f1(1) = 0.</span>
<span class="pysrc-output">f1(2) = 2.</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  bark(0).</span>
<span class="pysrc-output">- bark(1).</span>
<span class="pysrc-output">- bark(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- boxer(0).</span>
<span class="pysrc-output">- boxer(1).</span>
<span class="pysrc-output">  boxer(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  boxerdog(0).</span>
<span class="pysrc-output">- boxerdog(1).</span>
<span class="pysrc-output">- boxerdog(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">  dog(0).</span>
<span class="pysrc-output">- dog(1).</span>
<span class="pysrc-output">- dog(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- married(0).</span>
<span class="pysrc-output">- married(1).</span>
<span class="pysrc-output">  married(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- person(0).</span>
<span class="pysrc-output">- person(1).</span>
<span class="pysrc-output">  person(2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">- marry(0,0).</span>
<span class="pysrc-output">- marry(0,1).</span>
<span class="pysrc-output">- marry(0,2).</span>
<span class="pysrc-output">- marry(1,0).</span>
<span class="pysrc-output">- marry(1,1).</span>
<span class="pysrc-output">- marry(1,2).</span>
<span class="pysrc-output">- marry(2,0).</span>
<span class="pysrc-output">- marry(2,1).</span>
<span class="pysrc-output">  marry(2,2).</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d2</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">No model found!</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">Model for Discourse Thread d3</span>
<span class="pysrc-output">--------------------------------------------------------------------------------</span>
<span class="pysrc-output">No model found!</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Inconsistent discourse: d0 ['s0-r0', 's1-r0', 's2-r0', 's3-r0']:</span>
<span class="pysrc-output">    s0-r0: boxer(Vincent)</span>
<span class="pysrc-output">    s1-r0: boxer(Fido)</span>
<span class="pysrc-output">    s2-r0: married(Vincent)</span>
<span class="pysrc-output">    s3-r0: bark(Fido)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Consistent discourse: d1 ['s0-r0', 's1-r1', 's2-r0', 's3-r0']:</span>
<span class="pysrc-output">    s0-r0: boxer(Vincent)</span>
<span class="pysrc-output">    s1-r1: boxerdog(Fido)</span>
<span class="pysrc-output">    s2-r0: married(Vincent)</span>
<span class="pysrc-output">    s3-r0: bark(Fido)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Inconsistent discourse: d2 ['s0-r1', 's1-r0', 's2-r0', 's3-r0']:</span>
<span class="pysrc-output">    s0-r1: boxerdog(Vincent)</span>
<span class="pysrc-output">    s1-r0: boxer(Fido)</span>
<span class="pysrc-output">    s2-r0: married(Vincent)</span>
<span class="pysrc-output">    s3-r0: bark(Fido)</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">Inconsistent discourse: d3 ['s0-r1', 's1-r1', 's2-r0', 's3-r0']:</span>
<span class="pysrc-output">    s0-r1: boxerdog(Vincent)</span>
<span class="pysrc-output">    s1-r1: boxerdog(Fido)</span>
<span class="pysrc-output">    s2-r0: married(Vincent)</span>
<span class="pysrc-output">    s3-r0: bark(Fido)</span>
<span class="pysrc-output"></span></pre>
</td>
</tr></table></td></tr>
</table></div>
<!-- This will not be visible in the html output: create a tempdir to
play in.
>>> import tempfile, os
>>> tempdir = tempfile.mkdtemp()
>>> old_dir = os.path.abspath('.')
>>> os.chdir(tempdir) -->
<p>In order to play around with your own version of background knowledge,
you might want to start off with a local copy of <tt class="doctest"><span class="pre">background.fol</span></tt>:</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>nltk.data.retrieve(<span class="pysrc-string">'grammars/book_grammars/background.fol'</span>)
<span class="pysrc-output">Retrieving 'nltk:grammars/book_grammars/background.fol', saving to 'background.fol'</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<p>After you have modified the file, the <tt class="doctest"><span class="pre">parse_logic()</span></tt> function will parse
the strings in the file into expressions of <tt class="doctest"><span class="pre">nltk.logic</span></tt>.</p>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.inference.discourse <span class="pysrc-keyword">import</span> parse_fol
<span class="pysrc-prompt">&gt;&gt;&gt; </span>mybg = parse_fol(open(<span class="pysrc-string">'background.fol'</span>).read())</pre>
</td>
</tr></table></td></tr>
</table></div>
<p>The result can be loaded as an argument of <tt class="doctest"><span class="pre">add_background()</span></tt> in the
manner shown earlier.</p>
<!-- This will not be visible in the html output: clean up the tempdir.
>>> os.chdir(old_dir)
>>> for f in os.listdir(tempdir):
...     os.remove(os.path.join(tempdir, f))
>>> os.rmdir(tempdir)
>>> nltk.data.clear_cache() -->
</div>
<div class="section" id="regression-testing-from-book">
<h1>6&nbsp;&nbsp;&nbsp;Regression Testing from book</h1>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>logic._counter._value = 0</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.tag <span class="pysrc-keyword">import</span> RegexpTagger
<span class="pysrc-prompt">&gt;&gt;&gt; </span>tagger = RegexpTagger(
<span class="pysrc-more">... </span>    [(<span class="pysrc-string">'^(chases|runs)$'</span>, <span class="pysrc-string">'VB'</span>),
<span class="pysrc-more">... </span>     (<span class="pysrc-string">'^(a)$'</span>, <span class="pysrc-string">'ex_quant'</span>),
<span class="pysrc-more">... </span>     (<span class="pysrc-string">'^(every)$'</span>, <span class="pysrc-string">'univ_quant'</span>),
<span class="pysrc-more">... </span>     (<span class="pysrc-string">'^(dog|boy)$'</span>, <span class="pysrc-string">'NN'</span>),
<span class="pysrc-more">... </span>     (<span class="pysrc-string">'^(He)$'</span>, <span class="pysrc-string">'PRP'</span>)
<span class="pysrc-more">... </span>])
<span class="pysrc-prompt">&gt;&gt;&gt; </span>rc = DrtGlueReadingCommand(depparser=MaltParser(tagger=tagger))
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt = DiscourseTester(map(str.split, [<span class="pysrc-string">'Every dog chases a boy'</span>, <span class="pysrc-string">'He runs'</span>]), rc)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings()
<span class="pysrc-output"></span>
<span class="pysrc-output">s0 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s0-r0: ([z2],[boy(z2), (([z5],[dog(z5)]) -&gt; ([],[chases(z5,z2)]))])</span>
<span class="pysrc-output">s0-r1: ([],[(([z1],[dog(z1)]) -&gt; ([z2],[boy(z2), chases(z1,z2)]))])</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1 readings:</span>
<span class="pysrc-output"></span>
<span class="pysrc-output">s1-r0: ([z1],[PRO(z1), runs(z1)])</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(show_thread_readings=True)
<span class="pysrc-output">d0: ['s0-r0', 's1-r0'] : ([z1,z2],[boy(z1), (([z3],[dog(z3)]) -&gt; ([],[chases(z3,z1)])), (z2 = z1), runs(z2)])</span>
<span class="pysrc-output">d1: ['s0-r1', 's1-r0'] : INVALID: AnaphoraResolutionException</span>
<span class="pysrc-output"></span><span class="pysrc-prompt">&gt;&gt;&gt; </span>dt.readings(filter=True, show_thread_readings=True)
<span class="pysrc-output">d0: ['s0-r0', 's1-r0'] : ([z1,z3],[boy(z1), (([z2],[dog(z2)]) -&gt; ([],[chases(z2,z1)])), (z3 = z1), runs(z3)])</span></pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span>logic._counter._value = 0</pre>
</td>
</tr></table></td></tr>
</table></div>
<div class="doctest">
<table border="0" cellpadding="0" cellspacing="0" class="doctest" width="95%">
<tr><td class="doctest">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="copybar"
        onclick="javascript:copy_doctest_to_clipboard(this.nextSibling);"
        >&nbsp;</td>
<td class="pysrc"><pre class="doctest">
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.parse <span class="pysrc-keyword">import</span> FeatureEarleyChartParser
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">from</span> nltk.sem.drt <span class="pysrc-keyword">import</span> DrtParser
<span class="pysrc-prompt">&gt;&gt;&gt; </span>grammar = nltk.data.load(<span class="pysrc-string">'grammars/book_grammars/drt.fcfg'</span>, logic_parser=DrtParser())
<span class="pysrc-prompt">&gt;&gt;&gt; </span>parser = FeatureEarleyChartParser(grammar, trace=0)
<span class="pysrc-prompt">&gt;&gt;&gt; </span>trees = parser.nbest_parse(<span class="pysrc-string">'Angus owns a dog'</span>.split())
<span class="pysrc-prompt">&gt;&gt;&gt; </span><span class="pysrc-keyword">print</span>(trees[0].label()[<span class="pysrc-string">'SEM'</span>].simplify().normalize())
<span class="pysrc-output">([z1,z2],[Angus(z1), dog(z2), own(z1,z2)])</span></pre>
</td>
</tr></table></td></tr>
</table></div>
</div>
</div>
</body>
</html>
